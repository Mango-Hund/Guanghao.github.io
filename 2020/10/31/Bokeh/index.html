<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Bokeh交互式可视化 | Liu's blog</title><meta name="description" content="Python交互式可视化库"><meta name="keywords" content="绘图,可视化"><meta name="author" content="Guanghao"><meta name="copyright" content="Guanghao"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="http://lguanghao.com/2020/10/31/Bokeh/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="Bokeh交互式可视化"><meta property="og:url" content="http://lguanghao.com/2020/10/31/Bokeh/"><meta property="og:site_name" content="Liu's blog"><meta property="og:description" content="Python交互式可视化库"><meta property="og:image" content="http://lguanghao.com/img/bokeh.jpg"><meta property="article:published_time" content="2020-10-31T08:04:38.000Z"><meta property="article:modified_time" content="2020-10-31T06:17:33.339Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="next" title="自组织映射神经网络" href="http://lguanghao.com/2020/09/25/%E8%87%AA%E7%BB%84%E7%BB%87%E6%98%A0%E5%B0%84%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-10-31 14:17:33'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">26</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">22</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Bokeh简介"><span class="toc-number">1.</span> <span class="toc-text">Bokeh简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#基本绘图"><span class="toc-number">2.</span> <span class="toc-text">基本绘图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#导入和设置"><span class="toc-number">2.1.</span> <span class="toc-text">导入和设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#基本的散点图"><span class="toc-number">2.2.</span> <span class="toc-text">基本的散点图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#线形图"><span class="toc-number">2.3.</span> <span class="toc-text">线形图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本线形图"><span class="toc-number">2.3.1.</span> <span class="toc-text">基本线形图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#阶跃图"><span class="toc-number">2.3.2.</span> <span class="toc-text">阶跃图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多线图"><span class="toc-number">2.3.3.</span> <span class="toc-text">多线图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#缺失点线图"><span class="toc-number">2.3.4.</span> <span class="toc-text">缺失点线图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#堆叠线图"><span class="toc-number">2.3.5.</span> <span class="toc-text">堆叠线图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#直方图和矩形图"><span class="toc-number">2.4.</span> <span class="toc-text">直方图和矩形图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#直方图"><span class="toc-number">2.4.1.</span> <span class="toc-text">直方图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#堆叠直方图"><span class="toc-number">2.4.2.</span> <span class="toc-text">堆叠直方图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#矩形"><span class="toc-number">2.4.3.</span> <span class="toc-text">矩形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#六边形阵列"><span class="toc-number">2.4.4.</span> <span class="toc-text">六边形阵列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#有向面积图"><span class="toc-number">2.5.</span> <span class="toc-text">有向面积图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#单块有向面积"><span class="toc-number">2.5.1.</span> <span class="toc-text">单块有向面积</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#堆叠图"><span class="toc-number">2.5.2.</span> <span class="toc-text">堆叠图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#图块和多边形"><span class="toc-number">2.5.3.</span> <span class="toc-text">图块和多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多个图块"><span class="toc-number">2.5.4.</span> <span class="toc-text">多个图块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#缺失点"><span class="toc-number">2.5.5.</span> <span class="toc-text">缺失点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有洞多边形"><span class="toc-number">2.5.6.</span> <span class="toc-text">有洞多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有独立部分的多边形"><span class="toc-number">2.5.7.</span> <span class="toc-text">有独立部分的多边形</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#椭圆"><span class="toc-number">2.6.</span> <span class="toc-text">椭圆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#图像"><span class="toc-number">2.7.</span> <span class="toc-text">图像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#原始RGBA数据"><span class="toc-number">2.7.1.</span> <span class="toc-text">原始RGBA数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Colormapped图片"><span class="toc-number">2.7.2.</span> <span class="toc-text">Colormapped图片</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#段和射线"><span class="toc-number">2.8.</span> <span class="toc-text">段和射线</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#段"><span class="toc-number">2.8.1.</span> <span class="toc-text">段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#射线"><span class="toc-number">2.8.2.</span> <span class="toc-text">射线</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#楔形和弧"><span class="toc-number">2.9.</span> <span class="toc-text">楔形和弧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#弧"><span class="toc-number">2.9.1.</span> <span class="toc-text">弧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#楔形"><span class="toc-number">2.9.2.</span> <span class="toc-text">楔形</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网状图"><span class="toc-number">2.10.</span> <span class="toc-text">网状图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#地理图"><span class="toc-number">2.11.</span> <span class="toc-text">地理图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WMTS-Tile-Source"><span class="toc-number">2.11.1.</span> <span class="toc-text">WMTS Tile Source</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#结合多个图形"><span class="toc-number">2.12.</span> <span class="toc-text">结合多个图形</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#设置范围"><span class="toc-number">2.13.</span> <span class="toc-text">设置范围</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#指定轴的类型"><span class="toc-number">2.14.</span> <span class="toc-text">指定轴的类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#分类轴"><span class="toc-number">2.14.1.</span> <span class="toc-text">分类轴</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#时间轴"><span class="toc-number">2.14.2.</span> <span class="toc-text">时间轴</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#对数尺度轴"><span class="toc-number">2.14.3.</span> <span class="toc-text">对数尺度轴</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#共轭轴"><span class="toc-number">2.14.4.</span> <span class="toc-text">共轭轴</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#样式和主题"><span class="toc-number">3.</span> <span class="toc-text">样式和主题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#颜色和属性"><span class="toc-number">3.1.</span> <span class="toc-text">颜色和属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#颜色"><span class="toc-number">3.1.1.</span> <span class="toc-text">颜色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#属性"><span class="toc-number">3.1.2.</span> <span class="toc-text">属性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Line属性"><span class="toc-number">3.1.2.1.</span> <span class="toc-text">Line属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Fill属性"><span class="toc-number">3.1.2.2.</span> <span class="toc-text">Fill属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Text属性"><span class="toc-number">3.1.2.3.</span> <span class="toc-text">Text属性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Plots（框图）"><span class="toc-number">3.2.</span> <span class="toc-text">Plots（框图）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Glyphs（标记符号）"><span class="toc-number">3.3.</span> <span class="toc-text">Glyphs（标记符号）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#选择和非选择-视觉效果"><span class="toc-number">3.3.1.</span> <span class="toc-text">选择和非选择 视觉效果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Axes（轴）"><span class="toc-number">3.4.</span> <span class="toc-text">Axes（轴）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Grids-网格"><span class="toc-number">3.5.</span> <span class="toc-text">Grids(网格)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#添加注释"><span class="toc-number">4.</span> <span class="toc-text">添加注释</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Spans"><span class="toc-number">4.1.</span> <span class="toc-text">Spans</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Box-Annotations（Box注释）"><span class="toc-number">4.2.</span> <span class="toc-text">Box Annotations（Box注释）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Label（标签）"><span class="toc-number">4.3.</span> <span class="toc-text">Label（标签）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LabelSet（标签集）"><span class="toc-number">4.4.</span> <span class="toc-text">LabelSet（标签集）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Arrows-箭头"><span class="toc-number">4.5.</span> <span class="toc-text">Arrows(箭头)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Legends-图例"><span class="toc-number">4.6.</span> <span class="toc-text">Legends(图例)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Simple-Legends-简单图例"><span class="toc-number">4.6.1.</span> <span class="toc-text">Simple Legends(简单图例)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Color-bars（彩色柱状图）"><span class="toc-number">4.7.</span> <span class="toc-text">Color bars（彩色柱状图）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据源和数据转换"><span class="toc-number">5.</span> <span class="toc-text">数据源和数据转换</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#概要"><span class="toc-number">5.1.</span> <span class="toc-text">概要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建数据源"><span class="toc-number">5.2.</span> <span class="toc-text">创建数据源</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#通过-Python-Dicts-创建"><span class="toc-number">5.2.1.</span> <span class="toc-text">通过 Python Dicts 创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通过-Pandas-DataFrames-创建"><span class="toc-number">5.2.2.</span> <span class="toc-text">通过 Pandas DataFrames 创建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#转换数据"><span class="toc-number">5.3.</span> <span class="toc-text">转换数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#标记"><span class="toc-number">5.3.1.</span> <span class="toc-text">标记</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义JS变换"><span class="toc-number">5.3.2.</span> <span class="toc-text">自定义JS变换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#过滤数据"><span class="toc-number">5.4.</span> <span class="toc-text">过滤数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#索引过滤"><span class="toc-number">5.4.1.</span> <span class="toc-text">索引过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#布尔过滤器"><span class="toc-number">5.4.2.</span> <span class="toc-text">布尔过滤器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#群滤波器"><span class="toc-number">5.4.3.</span> <span class="toc-text">群滤波器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#演示布局"><span class="toc-number">6.</span> <span class="toc-text">演示布局</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#行与列"><span class="toc-number">6.1.</span> <span class="toc-text">行与列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Grids-Layout-for-Plots-网格布局"><span class="toc-number">6.2.</span> <span class="toc-text">Grids Layout for Plots(网格布局)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sizing-Mode"><span class="toc-number">6.3.</span> <span class="toc-text">Sizing Mode</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Modes"><span class="toc-number">6.3.1.</span> <span class="toc-text">Modes</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#关联和交互"><span class="toc-number">7.</span> <span class="toc-text">关联和交互</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#链接的行为"><span class="toc-number">7.1.</span> <span class="toc-text">链接的行为</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#链接平移"><span class="toc-number">7.1.1.</span> <span class="toc-text">链接平移</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#链接选择"><span class="toc-number">7.1.2.</span> <span class="toc-text">链接选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#链接属性"><span class="toc-number">7.1.3.</span> <span class="toc-text">链接属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#图例交互"><span class="toc-number">7.2.</span> <span class="toc-text">图例交互</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#隐藏图例"><span class="toc-number">7.2.1.</span> <span class="toc-text">隐藏图例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#添加小部件"><span class="toc-number">7.3.</span> <span class="toc-text">添加小部件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#回调函数"><span class="toc-number">7.3.1.</span> <span class="toc-text">回调函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#示例"><span class="toc-number">7.3.2.</span> <span class="toc-text">示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#按钮"><span class="toc-number">7.3.2.1.</span> <span class="toc-text">按钮</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#复选框按钮组"><span class="toc-number">7.3.2.2.</span> <span class="toc-text">复选框按钮组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#复选框"><span class="toc-number">7.3.2.3.</span> <span class="toc-text">复选框</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#颜色选择器"><span class="toc-number">7.3.2.4.</span> <span class="toc-text">颜色选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#数据表"><span class="toc-number">7.3.2.5.</span> <span class="toc-text">数据表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#时间选择器"><span class="toc-number">7.3.2.6.</span> <span class="toc-text">时间选择器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#日期范围滑块"><span class="toc-number">7.3.2.7.</span> <span class="toc-text">日期范围滑块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#div"><span class="toc-number">7.3.2.8.</span> <span class="toc-text">div</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#下拉选项"><span class="toc-number">7.3.2.9.</span> <span class="toc-text">下拉选项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#选择文件"><span class="toc-number">7.3.2.10.</span> <span class="toc-text">选择文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#多项选择"><span class="toc-number">7.3.2.11.</span> <span class="toc-text">多项选择</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#多选一"><span class="toc-number">7.3.2.12.</span> <span class="toc-text">多选一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#段落"><span class="toc-number">7.3.2.13.</span> <span class="toc-text">段落</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#密码输入框"><span class="toc-number">7.3.2.14.</span> <span class="toc-text">密码输入框</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pre文本"><span class="toc-number">7.3.2.15.</span> <span class="toc-text">Pre文本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#单选按钮组"><span class="toc-number">7.3.2.16.</span> <span class="toc-text">单选按钮组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#单选组"><span class="toc-number">7.3.2.17.</span> <span class="toc-text">单选组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#范围滑块"><span class="toc-number">7.3.2.18.</span> <span class="toc-text">范围滑块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#选择"><span class="toc-number">7.3.2.19.</span> <span class="toc-text">选择</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#滑块"><span class="toc-number">7.3.2.20.</span> <span class="toc-text">滑块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#微调控制项"><span class="toc-number">7.3.2.21.</span> <span class="toc-text">微调控制项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#选项卡"><span class="toc-number">7.3.2.22.</span> <span class="toc-text">选项卡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#文本区域输入"><span class="toc-number">7.3.2.23.</span> <span class="toc-text">文本区域输入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#开关按钮"><span class="toc-number">7.3.2.24.</span> <span class="toc-text">开关按钮</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/mountains.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Liu's blog</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Bokeh交互式可视化</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-10-31 16:04:38"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2020-10-31</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-10-31 14:17:33"><i class="fas fa-history fa-fw"></i> 更新于 2020-10-31</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/study/">study</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta__icon"></i><span>字数总计:</span><span class="word-count">12.3k</span><span class="post-meta__separator">|</span><i class="far fa-clock fa-fw post-meta__icon"></i><span>阅读时长: 55 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="Bokeh简介"><a href="#Bokeh简介" class="headerlink" title="Bokeh简介"></a>Bokeh简介</h1><p>Bokeh是用于现代浏览器端展示的交互式可视化库。它擅长于：</p>
<ul>
<li>现代浏览器端进行交互式可视化</li>
<li>独立的HTML文档，或者服务器后端应用</li>
<li>富于表现力的多种图形</li>
<li>大型，动态或流数据</li>
<li>适配 python (或者 Scala，R，…)</li>
</ul>
<p>最重要的是：</p>
<p>Bokeh的目标是以D3.js风格提供优雅简洁的图形展示，并与大数据或流数据进行高效交互。Bokeh可以帮助快速轻松地创建交互图，仪表板，和数据应用。</p>
<h1 id="基本绘图"><a href="#基本绘图" class="headerlink" title="基本绘图"></a>基本绘图</h1><p>这个章节主要讲解 bokeh.plotting 接口。这个接口是一个 “mid-level” 接口，主要思想如下描述：<br><strong>从简单的默认图表开始（使用合理的默认工具、网格和轴），添加标记和其他视觉属性直接与数据绑定的图形。</strong></p>
<h2 id="导入和设置"><a href="#导入和设置" class="headerlink" title="导入和设置"></a>导入和设置</h2><p>使用bokeh.plotting接口的时候,需要导入一些通用模块:</p>
<ul>
<li>使用figure函数创建plot对象.</li>
<li>调用函数ouptput_file,output_notebook,and outbook_server(可以组合使用)告诉Bokeh如何显示或者保存输出.</li>
<li>执行show和save显示或者保存图表.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.io <span class="keyword">import</span> output_notebook, show</span><br><span class="line"><span class="keyword">from</span> bokeh.plotting <span class="keyword">import</span> figure</span><br></pre></td></tr></table></figure>
<p>现在，我们在Jupyter notebook里调用 output_notebook()。我们只需要调用一次，然后所有后续对 show() 的调用都会在Notebook里内嵌显示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">output_notebook()</span><br></pre></td></tr></table></figure>
<div class="bk-root">
    <a href="https://bokeh.org" target="_blank" class="bk-logo bk-logo-small bk-logo-notebook"></a>
    <span id="10393">Loading BokehJS ...</span>
</div>




<h2 id="基本的散点图"><a href="#基本的散点图" class="headerlink" title="基本的散点图"></a>基本的散点图</h2><p>这一节,会明白如何使用Bokeh的各种标记创建简单的散点图.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#create a new plot with default tools, using figure</span></span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"><span class="comment">#add a circle renderer with a size, color, and alpha</span></span><br><span class="line">p.circle([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],[<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>], size=<span class="number">15</span>, line_color=<span class="string">"navy"</span>, fill_color=<span class="string">"orange"</span>, fill_alpha=<span class="number">10</span>)</span><br><span class="line"><span class="comment">#所有的Bokeh标记都具有 size 属性。Circles 还具有 radius 属性。</span></span><br><span class="line"><span class="comment">#fill_alpha是颜色深度</span></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="4db0ff00-a8bb-4106-b686-ae59bc826dbb" data-root-id="10394"></div>





<p>为了将散点图变成正方形标记而不是圆</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># create a new plot using figure</span></span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add a square renderer with a size, color, alpha, and sizes</span></span><br><span class="line">p.hex([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>], size=[<span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>, <span class="number">25</span>, <span class="number">30</span>], color=<span class="string">"firebrick"</span>, alpha=<span class="number">0.6</span>)</span><br><span class="line"></span><br><span class="line">show(p) <span class="comment"># show the results</span></span><br></pre></td></tr></table></figure>
<div class="bk-root" id="ad40d81b-2935-460d-b692-9909fb18eace" data-root-id="10826"></div>





<p>注意，在上面的例子中，我们还为每个标记指定不同的大小。 <strong>一般来说，所有标记符号的属性都可以通过这种形式 “向量化”</strong> 。 还要注意的是，我们通过 color 参数同时设置了线条和填充颜色。这是 bokeh.plotting 的一个特殊便利用法。<br>Bokeh有很多标记类型: </p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>.asterisk()</td>
<td>星形</td>
<td>.inverted_triangle()</td>
<td>倒三角形</td>
</tr>
<tr>
<td>.circle()</td>
<td>圆形</td>
<td>.sqaure()</td>
<td>正方形</td>
</tr>
<tr>
<td>.circle_cross()</td>
<td>圆形+十字</td>
<td>.square_cross()</td>
<td>正方形+十字</td>
</tr>
<tr>
<td>.circle_x()</td>
<td>圆形+叉</td>
<td>.sqaure_x</td>
<td>正方形+叉</td>
</tr>
<tr>
<td>.cross()</td>
<td>十字</td>
<td>.triangle()</td>
<td>三角形</td>
</tr>
<tr>
<td>.diamond()</td>
<td>菱形</td>
<td>.x()</td>
<td>叉</td>
</tr>
<tr>
<td>.diamond_cross()</td>
<td>菱形+十字</td>
<td>.hex</td>
<td>六边形</td>
</tr>
<tr>
<td>.dot()</td>
<td>点图</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
</div>
<h2 id="线形图"><a href="#线形图" class="headerlink" title="线形图"></a>线形图</h2><h3 id="基本线形图"><a href="#基本线形图" class="headerlink" title="基本线形图"></a>基本线形图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># create a new plot(with a title) using figure</span></span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>, title=<span class="string">"My First Line Plot"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#add a line renderer</span></span><br><span class="line">p.line([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],[<span class="number">6</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>], line_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="8737e301-7972-4b8c-941c-8af96b5ad076" data-root-id="11267"></div>





<h3 id="阶跃图"><a href="#阶跃图" class="headerlink" title="阶跃图"></a>阶跃图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add a steps renderer</span></span><br><span class="line">p.step([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>], line_width=<span class="number">2</span>, mode=<span class="string">"center"</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="815048f0-f7da-493a-9613-5bfc8e3fd8b4" data-root-id="11712"></div>





<h3 id="多线图"><a href="#多线图" class="headerlink" title="多线图"></a>多线图</h3><p>有时一次画多条线是有用的。这可以通过multi_line()方法完成:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">p.multi_line([[<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">6</span>]], [[<span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">5</span>]],</span><br><span class="line">             color=[<span class="string">"firebrick"</span>, <span class="string">"navy"</span>], alpha=[<span class="number">0.8</span>, <span class="number">0.3</span>], line_width=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="d7cd523c-0df2-4560-b8ae-a618e4e7343b" data-root-id="12170"></div>





<h3 id="缺失点线图"><a href="#缺失点线图" class="headerlink" title="缺失点线图"></a>缺失点线图</h3><p>NaN值可以传递给line()和multi_line()符号。在这种情况下，您以单个逻辑行对象结束，当呈现时，它有多个不相交的组件:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"><span class="comment"># add a line renderer with a NaN</span></span><br><span class="line">nan = float(<span class="string">'nan'</span>)</span><br><span class="line">p.line([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, nan, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>], line_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="82668da2-1d9b-4f68-9a75-237b0cb40217" data-root-id="12637"></div>





<h3 id="堆叠线图"><a href="#堆叠线图" class="headerlink" title="堆叠线图"></a>堆叠线图</h3><p>在某些情况下，希望将在公共索引上对齐的行堆叠起来(例如百分比的时间序列)。vline_stack()和hline_stack()便利方法可用于完成此任务。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> ColumnDataSource</span><br><span class="line">source = ColumnDataSource(data=dict(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">    y1=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    y2=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">))</span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">p.vline_stack([<span class="string">'y1'</span>, <span class="string">'y2'</span>], x=<span class="string">'x'</span>, source=source)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="cd055e01-6169-4318-ad54-9d1a2d966477" data-root-id="13114"></div>





<h2 id="直方图和矩形图"><a href="#直方图和矩形图" class="headerlink" title="直方图和矩形图"></a>直方图和矩形图</h2><h3 id="直方图"><a href="#直方图" class="headerlink" title="直方图"></a>直方图</h3><p>要通过指定(中心)x坐标、宽度以及顶部和底部端点来绘制直方图，使用vbar()函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.vbar(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], width=<span class="number">0.5</span>, bottom=<span class="number">0</span>,</span><br><span class="line">       top=[<span class="number">1.2</span>, <span class="number">2.5</span>, <span class="number">3.7</span>], color=<span class="string">"firebrick"</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="6d2c9588-5853-4bd5-b66e-c3d2337ebecb" data-root-id="13606"></div>





<p>通过指定(中心)y坐标、高度和左右端点来绘制水平条，使用hbar()函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.hbar(y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], height=<span class="number">0.5</span>, left=<span class="number">0</span>,</span><br><span class="line">       right=[<span class="number">1.2</span>, <span class="number">2.5</span>, <span class="number">3.7</span>], color=<span class="string">"navy"</span>)</span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="4abb12b9-7295-441e-8c9b-5156770c5830" data-root-id="14100"></div>





<h3 id="堆叠直方图"><a href="#堆叠直方图" class="headerlink" title="堆叠直方图"></a>堆叠直方图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">source = ColumnDataSource(data=dict(</span><br><span class="line">    y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">    x1=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    x2=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">))</span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">p.hbar_stack([<span class="string">'x1'</span>, <span class="string">'x2'</span>], y=<span class="string">'y'</span>, height=<span class="number">0.8</span>, color=(<span class="string">"grey"</span>, <span class="string">"lightgrey"</span>), source=source)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="28f72637-edce-44e4-8a94-b8cea263606f" data-root-id="14604"></div>





<h3 id="矩形"><a href="#矩形" class="headerlink" title="矩形"></a>矩形</h3><p>要通过指定左、右、上、下位置绘制以轴为单位的矩形(“四边”)，使用quad()函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.quad(top=[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], bottom=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], left=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       right=[<span class="number">1.2</span>, <span class="number">2.5</span>, <span class="number">3.7</span>], color=<span class="string">"#B3DE69"</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="5bc6aafc-7e6e-48e7-ab43-83ed32792762" data-root-id="15125"></div>





<p>若要通过指定中心点、宽度、高度和角度绘制任意矩形，使用rect()函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pi</span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.rect(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], width=<span class="number">0.2</span>, height=<span class="number">40</span>, color=<span class="string">"#CAB2D6"</span>,</span><br><span class="line">       angle=pi/<span class="number">3</span>, height_units=<span class="string">"screen"</span>)</span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="cb039e6c-e445-4077-8bd8-3b30ac53fdd6" data-root-id="15646"></div>





<h3 id="六边形阵列"><a href="#六边形阵列" class="headerlink" title="六边形阵列"></a>六边形阵列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> bokeh.util.hex <span class="keyword">import</span> axial_to_cartesian</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = np.array([<span class="number">0</span>,  <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>,  <span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line">r = np.array([<span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>,  <span class="number">0</span>,  <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>, toolbar_location=<span class="literal">None</span>)</span><br><span class="line">p.grid.visible = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">p.hex_tile(q, r, size=<span class="number">1</span>, fill_color=[<span class="string">"firebrick"</span>]*<span class="number">3</span> + [<span class="string">"navy"</span>]*<span class="number">4</span>,</span><br><span class="line">           line_color=<span class="string">"white"</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">x, y = axial_to_cartesian(q, r, <span class="number">1</span>, <span class="string">"pointytop"</span>)</span><br><span class="line"></span><br><span class="line">p.text(x, y, text=[<span class="string">"(%d, %d)"</span> % (q,r) <span class="keyword">for</span> (q, r) <span class="keyword">in</span> zip(q, r)],<span class="comment">#ip() 函数用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回由这些元组组成的列表</span></span><br><span class="line">       text_baseline=<span class="string">"middle"</span>, text_align=<span class="string">"center"</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="73704fee-19e8-4da1-bf97-5c2680e32676" data-root-id="16176"></div>





<p>下面一个更现实的例子使用hexbin()函数计算每个bin的计数，并绘制彩色映射计数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.transform <span class="keyword">import</span> linear_cmap</span><br><span class="line"><span class="keyword">from</span> bokeh.util.hex <span class="keyword">import</span> hexbin</span><br><span class="line"></span><br><span class="line">n = <span class="number">50000</span></span><br><span class="line">x = np.random.standard_normal(n)</span><br><span class="line">y = np.random.standard_normal(n)</span><br><span class="line"></span><br><span class="line">bins = hexbin(x, y, <span class="number">0.1</span>)<span class="comment">#0.1是尺寸</span></span><br><span class="line"></span><br><span class="line">p = figure(tools=<span class="string">"wheel_zoom,reset"</span>, match_aspect=<span class="literal">True</span>, background_fill_color=<span class="string">'#440154'</span>)</span><br><span class="line">p.grid.visible = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">p.hex_tile(q=<span class="string">"q"</span>, r=<span class="string">"r"</span>, size=<span class="number">0.1</span>, line_color=<span class="literal">None</span>, source=bins,</span><br><span class="line">           fill_color=linear_cmap(<span class="string">'counts'</span>, <span class="string">'Viridis256'</span>, <span class="number">0</span>, max(bins.counts)))<span class="comment"># 域 调色板 最小值 最大值</span></span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="6aa76ef6-0ac7-4226-b2a7-6fe2c533a450" data-root-id="16734"></div>





<h2 id="有向面积图"><a href="#有向面积图" class="headerlink" title="有向面积图"></a>有向面积图</h2><p>有向区域是两个共享公共索引的序列之间的填充区域。例如，一个垂直方向区域有一个x坐标数组和两个y坐标数组，分别是y1和y2，它们将被填充在两者之间。</p>
<h3 id="单块有向面积"><a href="#单块有向面积" class="headerlink" title="单块有向面积"></a>单块有向面积</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">p.varea(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">        y1=[<span class="number">2</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>],</span><br><span class="line">        y2=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="6cc32b50-de3d-4bda-8a1a-88c28372a54e" data-root-id="17270"></div>





<h3 id="堆叠图"><a href="#堆叠图" class="headerlink" title="堆叠图"></a>堆叠图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">source = ColumnDataSource(data=dict(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">    y1=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    y2=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">))</span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">p.varea_stack([<span class="string">'y1'</span>, <span class="string">'y2'</span>], x=<span class="string">'x'</span>, color=(<span class="string">"grey"</span>, <span class="string">"lightgrey"</span>), source=source)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="74450cd0-3035-496b-b145-8c175a34cf4f" data-root-id="17829"></div>





<h3 id="图块和多边形"><a href="#图块和多边形" class="headerlink" title="图块和多边形"></a>图块和多边形</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add a patch renderer with an alpha and line width</span></span><br><span class="line">p.patch([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">3</span>], alpha=<span class="number">0.5</span>, line_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="e4370284-e9fa-4b62-b8fa-6b05256af980" data-root-id="18405"></div>





<h3 id="多个图块"><a href="#多个图块" class="headerlink" title="多个图块"></a>多个图块</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">p.patches([[<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">6</span>]], [[<span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>], [<span class="number">4</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">5</span>]],</span><br><span class="line">          color=[<span class="string">"firebrick"</span>, <span class="string">"navy"</span>], alpha=[<span class="number">0.8</span>, <span class="number">0.3</span>], line_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="fbd3633a-e5bc-424c-a9d8-dd3ecf84519e" data-root-id="18981"></div>





<h3 id="缺失点"><a href="#缺失点" class="headerlink" title="缺失点"></a>缺失点</h3><p>与line()和multi_line()一样，可以将NaN值传递给patch()和patch()。在这种情况下，你会得到一个逻辑图块对象，当渲染时，它会有多个分离的组件:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add a patch renderer with a NaN value</span></span><br><span class="line">nan = float(<span class="string">'nan'</span>)</span><br><span class="line">p.patch([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, nan, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">6</span>, <span class="number">7</span>, <span class="number">5</span>, nan, <span class="number">7</span>, <span class="number">3</span>, <span class="number">6</span>], alpha=<span class="number">0.5</span>, line_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="d4900864-a3a2-4b9a-b9f9-bafbf8b23ed8" data-root-id="19566"></div>





<p>基本多边形</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.multi_polygons(xs=[[[[<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>]]]],</span><br><span class="line">                 ys=[[[[<span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>]]]])</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="78b40eac-dd19-4083-b9a5-3c0578c72a22" data-root-id="20160"></div>





<h3 id="有洞多边形"><a href="#有洞多边形" class="headerlink" title="有洞多边形"></a>有洞多边形</h3><p>下面的例子展示了如何从三个x和y点序列中生成一个带孔的多边形。第一个序列表示多边形的外部，下面的序列表示孔:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.multi_polygons(xs=[[[ [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>], [<span class="number">1.2</span>, <span class="number">1.6</span>, <span class="number">1.6</span>], [<span class="number">1.8</span>, <span class="number">1.8</span>, <span class="number">1.6</span>] ]]],</span><br><span class="line">                 ys=[[[ [<span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>], [<span class="number">3.2</span>, <span class="number">3.6</span>, <span class="number">3.2</span>], [<span class="number">3.4</span>, <span class="number">3.8</span>, <span class="number">3.8</span>] ]]])</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="91f5f385-e981-488d-9305-5e6f4d90529a" data-root-id="20763"></div>





<h3 id="有独立部分的多边形"><a href="#有独立部分的多边形" class="headerlink" title="有独立部分的多边形"></a>有独立部分的多边形</h3><p>有时一个多边形是由多个多边形几何组成的。下面的示例演示了如何从多个x和y点序列生成多边形符号。序列中的每一项都代表了多边形的一部分:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.multi_polygons(xs=[[[ [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>], [<span class="number">1.2</span>, <span class="number">1.6</span>, <span class="number">1.6</span>], [<span class="number">1.8</span>, <span class="number">1.8</span>, <span class="number">1.6</span>] ], [ [<span class="number">3</span>, <span class="number">4</span>, <span class="number">3</span>] ]]],</span><br><span class="line">                 ys=[[[ [<span class="number">4</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">3.2</span>, <span class="number">3.2</span>, <span class="number">3.6</span>], [<span class="number">3.4</span>, <span class="number">3.8</span>, <span class="number">3.8</span>] ], [ [<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>] ]]])</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="ebd9f476-7374-40ee-baa5-5068b62f376f" data-root-id="21375"></div>





<h2 id="椭圆"><a href="#椭圆" class="headerlink" title="椭圆"></a>椭圆</h2><p>ellipse()字形方法接受与rect()相同的属性，但呈现椭圆形状:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.ellipse(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], width=[<span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.1</span>], height=<span class="number">0.3</span>,</span><br><span class="line">          angle=pi/<span class="number">3</span>, color=<span class="string">"#CAB2D6"</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="fd9251ef-fcea-456b-bb56-e388e8fc88bd" data-root-id="21996"></div>





<h2 id="图像"><a href="#图像" class="headerlink" title="图像"></a>图像</h2><p>您可以使用image()、image_rgba()和image_url()符号方法在Bokeh图形上显示图像。可以使用悬停工具对图像符号进行交互式检查，以查看任意像素的值。有关如何启用图像悬停的更多信息，请参阅用户指南中的图像悬停部分。   </p>
<h3 id="原始RGBA数据"><a href="#原始RGBA数据" class="headerlink" title="原始RGBA数据"></a>原始RGBA数据</h3><p>下面的例子展示如何使用image_rgba方法显示原始RGBA数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division <span class="comment">#导入后"/"执行的是精确除法而不是截断除法</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">#set up some data</span></span><br><span class="line">N = <span class="number">20</span></span><br><span class="line">img = np.empty((N,N), dtype=np.uint32)</span><br><span class="line">view = img.view(dtype=np.uint8).reshape((N,N,<span class="number">4</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(N):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(N):</span><br><span class="line">        view[i,j,<span class="number">0</span>] = int(i/N*<span class="number">255</span>)  <span class="comment">#red</span></span><br><span class="line">        view[i,j,<span class="number">1</span>] = <span class="number">158</span>           <span class="comment">#green</span></span><br><span class="line">        view[i,j,<span class="number">2</span>] = int(j/N*<span class="number">255</span>)  <span class="comment">#blue</span></span><br><span class="line">        view[i,j,<span class="number">3</span>] = <span class="number">255</span>           <span class="comment">#alpha</span></span><br><span class="line"><span class="comment"># create a new plot (with a fixed range) using figure</span></span><br><span class="line">p = figure(x_range=[<span class="number">0</span>,<span class="number">10</span>], y_range=[<span class="number">0</span>,<span class="number">10</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># add an RGBA image renderer</span></span><br><span class="line">p.image_rgba(image=[img], x=[<span class="number">0</span>], y=[<span class="number">0</span>], dw=[<span class="number">10</span>], dh=[<span class="number">10</span>])<span class="comment">#x, y 偏移 dw\dh是宽和高</span></span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="a5ff2e4a-1e1d-48c0-92bf-0739fc5b0aea" data-root-id="22626"></div>





<h3 id="Colormapped图片"><a href="#Colormapped图片" class="headerlink" title="Colormapped图片"></a>Colormapped图片</h3><p>还可以提供标量值数组，并通过使用image()符号方法让Bokeh在浏览器中自动对数据着色。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">250</span>)</span><br><span class="line">y = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">250</span>)</span><br><span class="line">xx, yy = np.meshgrid(x, y)</span><br><span class="line">d = np.sin(xx)*np.cos(yy)</span><br><span class="line"></span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.x_range.range_padding = p.y_range.range_padding = <span class="number">0</span> </span><br><span class="line"></span><br><span class="line">p.image(image=[d], x=<span class="number">0</span>, y=<span class="number">0</span>, dw=<span class="number">10</span>, dh=<span class="number">10</span>, palette=<span class="string">"Spectral11"</span>, level=<span class="string">"image"</span>)</span><br><span class="line">p.grid.grid_line_width = <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="2abb4904-10bb-4d0b-b8cc-23b51132af5f" data-root-id="23265"></div>





<h2 id="段和射线"><a href="#段和射线" class="headerlink" title="段和射线"></a>段和射线</h2><h3 id="段"><a href="#段" class="headerlink" title="段"></a>段</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.segment(x0=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], y0=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], x1=[<span class="number">1.2</span>, <span class="number">2.4</span>, <span class="number">3.1</span>],</span><br><span class="line">          y1=[<span class="number">1.2</span>, <span class="number">2.5</span>, <span class="number">3.7</span>], color=<span class="string">"#F4A582"</span>, line_width=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="d0f0a1b5-f170-4715-8c04-657e9f8af28b" data-root-id="23915"></div>





<h3 id="射线"><a href="#射线" class="headerlink" title="射线"></a>射线</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.ray(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], length=<span class="number">45</span>, angle=[<span class="number">30</span>, <span class="number">45</span>, <span class="number">60</span>],</span><br><span class="line">      angle_units=<span class="string">"deg"</span>, color=<span class="string">"#FB8072"</span>, line_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="85d902e6-6fbe-4451-b6ef-d8e6c5efd60a" data-root-id="24572"></div>





<h2 id="楔形和弧"><a href="#楔形和弧" class="headerlink" title="楔形和弧"></a>楔形和弧</h2><h3 id="弧"><a href="#弧" class="headerlink" title="弧"></a>弧</h3><p>在绘制一个简单的直线圆弧时，Bokeh提供了arc()符号方法，它接受半径、start_angle和end_angle来确定位置。另外，direction属性决定在开始和结束的角度之间是顺时针渲染(“clock”)还是逆时针渲染(“anticlock”)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.arc(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], radius=<span class="number">0.1</span>, start_angle=<span class="number">0.4</span>, end_angle=<span class="number">4.8</span>, color=<span class="string">"navy"</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="883c25f7-de00-4151-a34c-bc081899a4e1" data-root-id="25238"></div>





<h3 id="楔形"><a href="#楔形" class="headerlink" title="楔形"></a>楔形</h3><p>wedge()方法与arc()的属性相同，但是呈现一个填充楔形:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.wedge(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], radius=<span class="number">0.2</span>, start_angle=<span class="number">0.4</span>, end_angle=<span class="number">4.8</span>,</span><br><span class="line">        color=<span class="string">"firebrick"</span>, alpha=<span class="number">0.6</span>, direction=<span class="string">"clock"</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="67d59b9c-8546-4124-9cb6-e513d9769b44" data-root-id="25913"></div>





<p>annular_wedge()符号方法类似于arc()，但绘制一个已填充区域。它接受一个inner_radius和outer_radius，而不只是半径:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.annular_wedge(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], inner_radius=<span class="number">0.1</span>, outer_radius=<span class="number">0.25</span>,</span><br><span class="line">                start_angle=<span class="number">0.4</span>, end_angle=<span class="number">4.8</span>, color=<span class="string">"green"</span>, alpha=<span class="number">0.6</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="f18aa230-5aa9-4d7e-96ef-7a72e6d21581" data-root-id="26597"></div>





<p>最后，可以使用接受inner_radius和outer_radius的annulus()方法绘制填充环:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.annulus(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], inner_radius=<span class="number">0.1</span>, outer_radius=<span class="number">0.25</span>,</span><br><span class="line">          color=<span class="string">"orange"</span>, alpha=<span class="number">0.6</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="d634b86a-ac6d-4c9c-8419-b86620a93ac8" data-root-id="27290"></div>





<h2 id="网状图"><a href="#网状图" class="headerlink" title="网状图"></a>网状图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> networkx <span class="keyword">as</span> nx</span><br><span class="line"></span><br><span class="line">G = nx.desargues_graph()</span><br><span class="line"><span class="keyword">from</span> bokeh.models.graphs <span class="keyword">import</span> from_networkx</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> Range1d, Plot</span><br><span class="line"></span><br><span class="line"><span class="comment"># We could use figure here but don't want all the axes and titles</span></span><br><span class="line">plot = Plot(x_range=Range1d(<span class="number">-1.1</span>,<span class="number">1.1</span>), y_range=Range1d(<span class="number">-1.1</span>,<span class="number">1.1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a Bokeh graph from the NetworkX input using nx.spring_layout</span></span><br><span class="line">graph = from_networkx(G, nx.spring_layout, scale=<span class="number">2</span>, center=(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">plot.renderers.append(graph)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set some of the default node glyph (Circle) properties</span></span><br><span class="line">graph.node_renderer.glyph.update(size=<span class="number">20</span>, fill_color=<span class="string">"orange"</span>)</span><br><span class="line"></span><br><span class="line">show(plot)</span><br></pre></td></tr></table></figure>
<pre><code>BokehDeprecationWarning: Importing from_networkx from bokeh.models.graphs is deprecated and will be removed in Bokeh 3.0. Import from bokeh.plotting instead
</code></pre><div class="bk-root" id="73a5cf36-0429-4cb5-83c9-dce699193879" data-root-id="27994"></div>






<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models.graphs <span class="keyword">import</span> NodesAndLinkedEdges</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> Circle, HoverTool, MultiLine</span><br><span class="line"></span><br><span class="line">G = nx.karate_club_graph()</span><br><span class="line"></span><br><span class="line"><span class="comment"># We could use figure here but don't want all the axes and titles</span></span><br><span class="line">plot = Plot(x_range=Range1d(<span class="number">-1.1</span>,<span class="number">1.1</span>), y_range=Range1d(<span class="number">-1.1</span>,<span class="number">1.1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a Bokeh graph from the NetworkX input using nx.spring_layout</span></span><br><span class="line">graph = from_networkx(G, nx.spring_layout, scale=<span class="number">2</span>, center=(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">plot.renderers.append(graph)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Blue circles for nodes, and light grey lines for edges</span></span><br><span class="line">graph.node_renderer.glyph = Circle(size=<span class="number">25</span>, fill_color=<span class="string">'#2b83ba'</span>)</span><br><span class="line">graph.edge_renderer.glyph = MultiLine(line_color=<span class="string">"#cccccc"</span>, line_alpha=<span class="number">0.8</span>, line_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># green hover for both nodes and edges</span></span><br><span class="line">graph.node_renderer.hover_glyph = Circle(size=<span class="number">25</span>, fill_color=<span class="string">'#abdda4'</span>)</span><br><span class="line">graph.edge_renderer.hover_glyph = MultiLine(line_color=<span class="string">'#abdda4'</span>, line_width=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># When we hover over nodes, highlight adjecent edges too</span></span><br><span class="line">graph.inspection_policy = NodesAndLinkedEdges()</span><br><span class="line"></span><br><span class="line">plot.add_tools(HoverTool(tooltips=<span class="literal">None</span>))</span><br><span class="line"></span><br><span class="line">show(plot)</span><br></pre></td></tr></table></figure>
<pre><code>BokehDeprecationWarning: Importing from_networkx from bokeh.models.graphs is deprecated and will be removed in Bokeh 3.0. Import from bokeh.plotting instead
</code></pre><div class="bk-root" id="8da3b94e-a63e-4951-982b-6c091bb9c658" data-root-id="28771"></div>





<h2 id="地理图"><a href="#地理图" class="headerlink" title="地理图"></a>地理图</h2><p>将数据集与真实世界上下文联系起来非常有用。你可以像任何其他类型的数据一样绘制地理数据，例如 <a href="https://bokeh.pydata.org/en/latest/docs/gallery/texas.html" target="_blank" rel="noopener">Texas Unemployment example</a> 的例子。但Bokeh提供了一些在地理坐标绘图的专门机制：</p>
<ol>
<li><p><a href="https://bokeh.pydata.org/en/latest/docs/user_guide/geo.html#google-maps-support" target="_blank" rel="noopener">GMapPlot</a>: Bokeh 基于 Google Maps 绘图</p>
</li>
<li><p><a href="https://bokeh.pydata.org/en/latest/docs/user_guide/geo.html#tile-providers" target="_blank" rel="noopener">TileSource</a>, 特别是wmtstilesource：允许数据被覆盖于任何地图平铺显示服务器和自定义服务器的数据上，包括： <code>Google Maps, Stamen, MapQuest, OpenStreetMap, ESRI</code>,</p>
</li>
<li><p><a href="https://bokeh.pydata.org/en/dev/docs/user_guide/geo.html#geojson-datasource" target="_blank" rel="noopener">GeoJSONDataSource</a>: 可使 GeoJSON 类型数据用于Bokeh绘图，就像 ColumnDataSource 类型。</p>
</li>
</ol>
<h3 id="WMTS-Tile-Source"><a href="#WMTS-Tile-Source" class="headerlink" title="WMTS Tile Source"></a>WMTS Tile Source</h3><p>WTMS是最常见的平铺地图数据Web标准，即地图由标准大小的图块拼接而成，如此则可以在一个给定的缩放级别构造整个地图。WTMS使用Web Mercator格式，从英国的格林尼治向北向西测量距离，这样容易计算但不会扭曲全球形状。</p>
<p>首先，我们创建一个覆盖美国的空白Bokeh图，范围按米计算：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.plotting <span class="keyword">import</span> figure</span><br><span class="line"><span class="keyword">from</span> bokeh.models.tiles <span class="keyword">import</span> WMTSTileSource</span><br><span class="line"></span><br><span class="line"><span class="comment"># web mercator coordinates</span></span><br><span class="line">USA = x_range,y_range = ((<span class="number">-13884029</span>,<span class="number">-7453304</span>), (<span class="number">2698291</span>,<span class="number">6455972</span>))</span><br><span class="line"></span><br><span class="line">p = figure(tools=<span class="string">'pan, wheel_zoom'</span>, x_range=x_range, y_range=y_range)</span><br><span class="line">p.axis.visible = <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<p>bokeh.models.tiles 中提供了几个WTMS地图源。在这里展示通过使用格式字符串接口，Bokeh如何根据所需的缩放，X和Y值从供应商处请求图片：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">url = <span class="string">'http://a.basemaps.cartocdn.com/dark_all/&#123;Z&#125;/&#123;X&#125;/&#123;Y&#125;.png'</span></span><br><span class="line">attribution = <span class="string">"Tiles by Carto, under CC BY 3.0. Data by OSM, under ODbL"</span></span><br><span class="line"></span><br><span class="line">p.add_tile(WMTSTileSource(url=url, attribution=attribution))</span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="85016fdc-cfcf-466a-911f-de1969ab838a" data-root-id="29577"></div>





<p>这就是在图表中放入地图数据要做的全部！当然，您通常还希望显示其他数据，除非您只想使用服务器提供的地图。现在，只要您能得到Web Mercator格式的坐标，您可以把任何您平常使用Bokeh图表想表达的东西添加到地图上。例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wgs84_to_web_mercator</span><span class="params">(df, lon=<span class="string">"lon"</span>, lat=<span class="string">"lat"</span>)</span>:</span></span><br><span class="line">    <span class="string">"""Converts decimal longitude/latitude to Web Mercator format"""</span></span><br><span class="line">    k = <span class="number">6378137</span></span><br><span class="line">    df[<span class="string">"x"</span>] = df[lon] * (k * np.pi/<span class="number">180.0</span>)</span><br><span class="line">    df[<span class="string">"y"</span>] = np.log(np.tan((<span class="number">90</span> + df[lat]) * np.pi/<span class="number">360.0</span>)) * k</span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(dict(name=[<span class="string">"Austin"</span>, <span class="string">"NYC"</span>], lon=[<span class="number">-97.7431</span>,<span class="number">-74.0059</span>], lat=[<span class="number">30.2672</span>,<span class="number">40.7128</span>]))</span><br><span class="line">wgs84_to_web_mercator(df)</span><br><span class="line">p.circle(x=df[<span class="string">'x'</span>], y=df[<span class="string">'y'</span>], fill_color=<span class="string">'orange'</span>, size=<span class="number">10</span>)</span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="e10ce9a0-5785-4f9e-a6b2-0936e18b8ddb" data-root-id="29577"></div>





<h2 id="结合多个图形"><a href="#结合多个图形" class="headerlink" title="结合多个图形"></a>结合多个图形</h2><p>将多个函数组合在单一绘图上，就是在单个图形上调用多个函数方法:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">y = [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add both a line and circles on the same plot</span></span><br><span class="line">p.line(x, y, line_width=<span class="number">2</span>)</span><br><span class="line">p.circle(x, y, fill_color=<span class="string">"white"</span>, size=<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="44046399-02a9-4e43-8540-1b23f6751ea6" data-root-id="30999"></div>





<h2 id="设置范围"><a href="#设置范围" class="headerlink" title="设置范围"></a>设置范围</h2><p>默认情况下，散景会尝试自动设置图形的数据边界，以紧贴数据。有时，您可能需要显式地设置图形的范围。这可以通过使用Range1d对象来设置x_range或y_range属性来完成，这个对象给出了你想要的范围的起始点和结束点:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> Range1d</span><br><span class="line"><span class="comment"># create a new plot with a range set with a tuple</span></span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>, x_range=(<span class="number">0</span>, <span class="number">20</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># set a range using a Range1d</span></span><br><span class="line">p.y_range = Range1d(<span class="number">0</span>, <span class="number">15</span>)</span><br><span class="line"></span><br><span class="line">p.circle([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">7</span>], size=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="4a2508fd-3741-47a7-8154-1a77ed941e3d" data-root-id="31772"></div>





<p>范围还有一个bounds属性，它允许您指定您不希望用户能够平移/缩放的范围。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># set a range using a Range1d</span></span><br><span class="line">p.y_range = Range1d(<span class="number">0</span>, <span class="number">15</span>, bounds=(<span class="number">0</span>, <span class="literal">None</span>))</span><br></pre></td></tr></table></figure>
<h2 id="指定轴的类型"><a href="#指定轴的类型" class="headerlink" title="指定轴的类型"></a>指定轴的类型</h2><p>上面的示例都使用默认的线性轴。这个轴适用于许多需要在线性尺度上显示数值数据的图。在其他情况下，您可能拥有分类数据，或者需要在日期时间或日志尺度上显示数值数据。本节演示在使用 bokeh.plotting 如何指定轴类型。</p>
<h3 id="分类轴"><a href="#分类轴" class="headerlink" title="分类轴"></a>分类轴</h3><p>通过为绘图范围之一指定一个范围(或要转换为一个元素的列表)来创建类别轴。下面是一个简单的示例，详细信息请参见处理分类数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">factors = [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>, <span class="string">"g"</span>, <span class="string">"h"</span>]</span><br><span class="line">x = [<span class="number">50</span>, <span class="number">40</span>, <span class="number">65</span>, <span class="number">10</span>, <span class="number">25</span>, <span class="number">37</span>, <span class="number">80</span>, <span class="number">60</span>]</span><br><span class="line"></span><br><span class="line">p = figure(y_range=factors)</span><br><span class="line"></span><br><span class="line">p.circle(x, factors, size=<span class="number">15</span>, fill_color=<span class="string">"orange"</span>, line_color=<span class="string">"green"</span>, line_width=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="5fea84a5-c3e2-44c6-a7d2-5dce535b05cc" data-root-id="33214"></div>





<h3 id="时间轴"><a href="#时间轴" class="headerlink" title="时间轴"></a>时间轴</h3><p>在处理timeseries数据或任何涉及日期或时间的数据时，最好有一个轴来显示适合不同日期和时间尺度的标签。<br>我们已经了解了如何使用figure()函数来创建使用 bokeh.plotting的图形。这个函数接受x_axis_type和y_axis_type作为参数。若要指定日期时间轴，请将这两个参数的值传递给“datetime”。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> bokeh.sampledata</span><br><span class="line"><span class="keyword">from</span> bokeh.sampledata.stocks <span class="keyword">import</span> AAPL</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(AAPL)</span><br><span class="line">df[<span class="string">'date'</span>] = pd.to_datetime(df[<span class="string">'date'</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment">#create a new plot with a datetime axis type</span></span><br><span class="line">p = figure(plot_width=<span class="number">800</span>, plot_height=<span class="number">250</span>, x_axis_type=<span class="string">"datetime"</span>)</span><br><span class="line"></span><br><span class="line">p.line(df[<span class="string">'date'</span>], df[<span class="string">'close'</span>], color=<span class="string">'navy'</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="ac5e2261-e388-427f-beb4-6a5c4e87a660" data-root-id="33987"></div>





<h3 id="对数尺度轴"><a href="#对数尺度轴" class="headerlink" title="对数尺度轴"></a>对数尺度轴</h3><p>当处理指数增长或多个数量级的数据时，通常需要在对数尺度上有一个轴。另一个场景涉及到绘制具有幂律关系的数据，当需要在两个轴上使用对数尺度时。</p>
<p>正如我们在上面看到的，figure()函数接受x_axis_type和y_axis_type作为参数。要指定一个日志轴，将这些参数的值传递给“log”。</p>
<p>默认情况下，计算对数轴范围以适应正值数据。若要设置自己的范围，请参阅Setting Ranges一节。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">0.1</span>, <span class="number">0.5</span>, <span class="number">1.0</span>, <span class="number">1.5</span>, <span class="number">2.0</span>, <span class="number">2.5</span>, <span class="number">3.0</span>]</span><br><span class="line">y = [<span class="number">10</span>**xx <span class="keyword">for</span> xx <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line"><span class="comment"># create a new plot with a log axis type</span></span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>, y_axis_type=<span class="string">"log"</span>)</span><br><span class="line"></span><br><span class="line">p.line(x, y, line_width=<span class="number">2</span>)</span><br><span class="line">p.circle(x, y, fill_color=<span class="string">"white"</span>, size=<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="05864962-d9f6-4f6c-af09-a2a09d522cbe" data-root-id="34854"></div>





<h3 id="共轭轴"><a href="#共轭轴" class="headerlink" title="共轭轴"></a>共轭轴</h3><p>可以向单个绘图区添加表示不同范围的多个轴。为此，在extra_x_range和extra_y_range属性中配置“extra”命名范围。然后，可以在添加新的字形方法时引用这些已命名的范围，也可以使用Plot上的add_layout方法添加新的轴对象。下面给出一个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> arange, linspace, pi, sin</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> LinearAxis, Range1d</span><br><span class="line"></span><br><span class="line">x = arange(<span class="number">-2</span>*pi, <span class="number">2</span>*pi, <span class="number">0.1</span>)</span><br><span class="line">y = sin(x)</span><br><span class="line">y2 = linspace(<span class="number">0</span>, <span class="number">100</span>, len(y))</span><br><span class="line">p = figure(x_range=(<span class="number">-6.5</span>, <span class="number">6.5</span>), y_range=(<span class="number">-1.1</span>, <span class="number">1.1</span>))</span><br><span class="line"></span><br><span class="line">p.circle(x, y, color=<span class="string">"red"</span>)</span><br><span class="line"></span><br><span class="line">p.extra_y_ranges = &#123;<span class="string">"foo"</span>: Range1d(start=<span class="number">0</span>, end=<span class="number">100</span>)&#125;</span><br><span class="line">p.circle(x, y2, color=<span class="string">"blue"</span>, y_range_name=<span class="string">"foo"</span>)</span><br><span class="line">p.add_layout(LinearAxis(y_range_name=<span class="string">"foo"</span>), <span class="string">'left'</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="55ad378c-731c-4896-a8b3-baecab5a124e" data-root-id="35677"></div>





<h1 id="样式和主题"><a href="#样式和主题" class="headerlink" title="样式和主题"></a>样式和主题</h1><h2 id="颜色和属性"><a href="#颜色和属性" class="headerlink" title="颜色和属性"></a>颜色和属性</h2><h3 id="颜色"><a href="#颜色" class="headerlink" title="颜色"></a>颜色</h3><p>有许多地方可能需要指定颜色。Bokeh可以各种不同的方式指定颜色：</p>
<ul>
<li>任意一个147种CSS颜色名称,如’green’,’indigo’</li>
<li>十六进制的RGB(A)值,如,’#FF0000’,’#444444444’</li>
<li>整数3元组(r,g,b),其中整数位于0和255之间</li>
<li>4元组(r,g,b,a),其中r,g,b是0与255之间的整数,a是0与1之间的浮点数<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3>无论用哪个API (models, plotting, charts) 创建Bokeh图表，都可以通过设置Bokeh模型对象的属性来定型其视觉样式。视觉样式属性分为三种类型：line, fill, text。相关的代码和示例完整信息，请参见用户指南的 <a href="http://bokeh.pydata.org/en/latest/docs/user_guide/styling.html" target="_blank" rel="noopener">视觉样式属性</a> 章节。<h4 id="Line属性"><a href="#Line属性" class="headerlink" title="Line属性"></a>Line属性</h4>设置线条的视觉外观。最常见的是 line_color, line_alpha, line_width， line_dash。<h4 id="Fill属性"><a href="#Fill属性" class="headerlink" title="Fill属性"></a>Fill属性</h4>设置填充区域的外观：fill_color， fill_alpha。<h4 id="Text属性"><a href="#Text属性" class="headerlink" title="Text属性"></a>Text属性</h4>设置文本行的视觉外观。最常见的是 text_font, text_font_size, text_color, text_alpha </li>
</ul>
<p>有时属性名会有一个前缀，为了区分同一对象的不同line属性，或为了名称更能表达意思。例如，为了设置轮廓线的宽度，可以用 <code>myplot.outline_line_width = 2</code>。</p>
<h2 id="Plots（框图）"><a href="#Plots（框图）" class="headerlink" title="Plots（框图）"></a>Plots（框图）</h2><p>可以设置plot的多个顶层属性（outline, border等）<a href="http://bokeh.pydata.org/en/latest/docs/user_guide/styling.html#plots" target="_blank" rel="noopener">框图</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># create a new plot with a title</span></span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.outline_line_width = <span class="number">7</span></span><br><span class="line">p.outline_line_alpha = <span class="number">0.3</span></span><br><span class="line">p.outline_line_color = <span class="string">"navy"</span></span><br><span class="line"></span><br><span class="line">p.circle([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], [<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">7</span>], size=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="2ef2940a-d522-4f5f-8d93-fd778aaa0026" data-root-id="36527"></div>





<h2 id="Glyphs（标记符号）"><a href="#Glyphs（标记符号）" class="headerlink" title="Glyphs（标记符号）"></a>Glyphs（标记符号）</h2><p>我们可以对glyph对象的视觉属性进行设计。当使用 bokeh.plotting 时，通常在调用glyph方法时指定，如：</p>
<p><code>p.circle(line_color=&quot;red&quot;, fill_alpha=0.2, ...)</code></p>
<p>也可以直接设置glyph对象的属性。Glyph对象是 GlyphRenderer 找到的对象，由 Plot.add_glyph 和 circle, rect 这样的 bokeh.plotting glyph方法返回。我们看一个例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># keep a reference to the returned GlyphRenderer</span></span><br><span class="line">r = p.circle([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], [<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">7</span>])</span><br><span class="line"></span><br><span class="line">r.glyph.size = <span class="number">50</span></span><br><span class="line">r.glyph.fill_alpha = <span class="number">0.2</span></span><br><span class="line">r.glyph.line_color = <span class="string">"firebrick"</span></span><br><span class="line">r.glyph.line_dash = [<span class="number">5</span>, <span class="number">1</span>]</span><br><span class="line">r.glyph.line_width = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="8f347d7b-7b96-4248-a6ed-e7a7f5cccbe1" data-root-id="37355"></div>





<h3 id="选择和非选择-视觉效果"><a href="#选择和非选择-视觉效果" class="headerlink" title="选择和非选择 视觉效果"></a>选择和非选择 视觉效果</h3><p>你可以控制被选择的glyphs看起来是怎么样的。“被选择”的点根据GlyphRenderer的.selection_glyph属性选项显示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">如果设置了“非选择”，则未被选择的点按照GlyphRenderer的.nonselection_glyph属性选项显示：</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;r.nonselection_glyph &#x3D; Circle(fill_alpha&#x3D;0.2, fill_color&#x3D;&quot;grey&quot;, line_color&#x3D;None)</span><br></pre></td></tr></table></figure>
<p>使用bokeh.plotting接口时，将这些视觉属性传递给glyph方法比较容易，如下所示。glyph方法将创建的选择或非选择glyph并渲染。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>, tools=<span class="string">"tap"</span>, title=<span class="string">"Select a circle"</span>)</span><br><span class="line">renderer = p.circle([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">7</span>], size=<span class="number">50</span>,</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># set visual properties for selected glyphs</span></span><br><span class="line">                    selection_color=<span class="string">"firebrick"</span>,</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># set visual properties for non-selected glyphs</span></span><br><span class="line">                    nonselection_fill_alpha=<span class="number">0.2</span>,</span><br><span class="line">                    nonselection_fill_color=<span class="string">"grey"</span>,</span><br><span class="line">                    nonselection_line_color=<span class="string">"firebrick"</span>,</span><br><span class="line">                    nonselection_line_alpha=<span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="1e0c4d3e-ea3a-4181-8d43-828e91808cfc" data-root-id="38192"></div>





<p>可以指定被“inspected”的glyph的视觉外观，例如，由一个悬停工具。这通过设置GlyphRenderer的一个可选属性hover_glyph完成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">如果使用bokeh.plotting，则可以通过给glyph方法传递hover_fill_alpha参数。让我们看一个采用&quot;hline&quot;模式配置HoverTool的例子。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;python</span><br><span class="line">from bokeh.models.tools import HoverTool</span><br><span class="line">from bokeh.sampledata.glucose import data</span><br><span class="line"></span><br><span class="line">subset &#x3D; data.loc[&#39;2010-10-06&#39;]</span><br><span class="line"></span><br><span class="line">x, y &#x3D; subset.index.to_series(), subset[&#39;glucose&#39;]</span><br><span class="line"></span><br><span class="line"># Basic plot setup</span><br><span class="line">p &#x3D; figure(width&#x3D;600, height&#x3D;300, x_axis_type&#x3D;&quot;datetime&quot;, title&#x3D;&#39;Hover over points&#39;)</span><br><span class="line"></span><br><span class="line">p.line(x, y, line_dash&#x3D;&quot;4 4&quot;, line_width&#x3D;1, color&#x3D;&#39;gray&#39;)</span><br><span class="line"></span><br><span class="line">cr &#x3D; p.circle(x, y, size&#x3D;20,</span><br><span class="line">              fill_color&#x3D;&quot;grey&quot;, hover_fill_color&#x3D;&quot;firebrick&quot;,</span><br><span class="line">              fill_alpha&#x3D;0.05, hover_alpha&#x3D;0.3,</span><br><span class="line">              line_color&#x3D;None, hover_line_color&#x3D;&quot;white&quot;)</span><br><span class="line"></span><br><span class="line">p.add_tools(HoverTool(tooltips&#x3D;None, renderers&#x3D;[cr], mode&#x3D;&#39;hline&#39;))</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="f540d006-8afc-4a98-b414-d4b3a5e74a68" data-root-id="39016"></div>





<h2 id="Axes（轴）"><a href="#Axes（轴）" class="headerlink" title="Axes（轴）"></a>Axes（轴）</h2><p>要指定Axis的视觉样式，你首先必须找到Axis对象。最简单的方法是使用Plot的一些便利方法：axis, xaxis, yaxis。这些方法返回轴对象的列表：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>p.xaxis</span><br><span class="line">[&lt;bokeh.models.axes.LinearAxis at <span class="number">0x106fa2390</span>&gt;]</span><br></pre></td></tr></table></figure><br>但是，您可以设置列表中所有元素的属性，就像它是一个对象一样：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p.xaxis.axis_label = <span class="string">"Temperature"</span></span><br><span class="line">p.axis.major_label_text_color = <span class="string">"orange"</span></span><br></pre></td></tr></table></figure><br>这些被称为“splattable”列表，以及它们的tab补全。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pi</span><br><span class="line"></span><br><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.x([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], [<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">7</span>], size=<span class="number">10</span>, line_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">p.xaxis.major_label_orientation = pi/<span class="number">4</span></span><br><span class="line">p.yaxis.major_label_orientation = <span class="string">"vertical"</span></span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="42fc16bb-bd33-45a7-bd56-5e679f2a9fee" data-root-id="39970"></div>






<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.asterisk([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], [<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">7</span>], size=<span class="number">12</span>, color=<span class="string">"olive"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># change just some things about the x-axes</span></span><br><span class="line">p.xaxis.axis_label = <span class="string">"Temp"</span></span><br><span class="line">p.xaxis.axis_line_width = <span class="number">3</span></span><br><span class="line">p.xaxis.axis_line_color = <span class="string">"red"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># change just some things about the y-axes</span></span><br><span class="line">p.yaxis.axis_label = <span class="string">"Pressure"</span></span><br><span class="line">p.yaxis.major_label_text_color = <span class="string">"orange"</span></span><br><span class="line">p.yaxis.major_label_orientation = <span class="string">"vertical"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># change things on all axes 刻度</span></span><br><span class="line">p.axis.minor_tick_in = <span class="number">-3</span></span><br><span class="line">p.axis.minor_tick_out = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="b4e9d343-f96f-4cd2-a9aa-581c3d496224" data-root-id="40845"></div>





<h2 id="Grids-网格"><a href="#Grids-网格" class="headerlink" title="Grids(网格)"></a>Grids(网格)</h2><p><a href="http://bokeh.pydata.org/en/latest/docs/user_guide/styling.html#grids" target="_blank" rel="noopener">Grids</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.circle([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], [<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">7</span>], size=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># change just some things about the x-grid</span></span><br><span class="line">p.xgrid.grid_line_color = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># change just some things about the y-grid</span></span><br><span class="line">p.ygrid.grid_line_alpha = <span class="number">0.5</span></span><br><span class="line">p.ygrid.grid_line_dash = [<span class="number">6</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="b6011402-d494-403d-9fdc-6f5613d4be7c" data-root-id="41729"></div>






<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.circle([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>], [<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">7</span>], size=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># change just some things about the x-grid</span></span><br><span class="line">p.xgrid.grid_line_color = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># change just some things about the y-grid</span></span><br><span class="line">p.ygrid.band_fill_alpha = <span class="number">0.1</span></span><br><span class="line">p.ygrid.band_fill_color = <span class="string">"navy"</span></span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="2a657125-f87c-44e0-9e3b-999fdb4a212d" data-root-id="42622"></div>





<h1 id="添加注释"><a href="#添加注释" class="headerlink" title="添加注释"></a>添加注释</h1><p>有时，我们想给图表添加一些视觉提示（边界线，阴影区域，标签和箭头等），以增强某些效果。Bokeh有几个类似的注释类型。通常，要添加注释，我们直接创建“low level”注释对象，并使用add_layout添加到我们的Plot、Figure 或 Chart中。让我们看看一些具体的例子。</p>
<h2 id="Spans"><a href="#Spans" class="headerlink" title="Spans"></a>Spans</h2><p>Spans是“无限”的垂直线或水平线。在创建它们时，指定要跨越的dimension（即width或height）、线的外观视觉属性以及绘制该直线所需的位置。让我们来看一个示例，将两个水平span添加到一个简单的图中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> bokeh.models.annotations <span class="keyword">import</span> Span</span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">20</span>, <span class="number">200</span>)</span><br><span class="line">y = np.sin(x)</span><br><span class="line"></span><br><span class="line">p = figure(y_range=(<span class="number">-2</span>, <span class="number">2</span>))</span><br><span class="line">p.line(x, y)</span><br><span class="line"></span><br><span class="line">upper = Span(location=<span class="number">1</span>, dimension=<span class="string">'width'</span>, line_color=<span class="string">'olive'</span>, line_width=<span class="number">4</span>)</span><br><span class="line">p.add_layout(upper)</span><br><span class="line"></span><br><span class="line">lower = Span(location=<span class="number">-1</span>, dimension=<span class="string">'width'</span>, line_color=<span class="string">'firebrick'</span>, line_width=<span class="number">4</span>)</span><br><span class="line">p.add_layout(lower)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="12762f30-b353-4e54-995b-a1f58cb584ef" data-root-id="43524"></div>





<h2 id="Box-Annotations（Box注释）"><a href="#Box-Annotations（Box注释）" class="headerlink" title="Box Annotations（Box注释）"></a>Box Annotations（Box注释）</h2><p>有时您可能需要通过绘制一个阴影框来突出图中的某些区域。BoxAnnotation可以做到，其通过如下属性以及任一line和fill视觉属性来控制外观：</p>
<ul>
<li>top</li>
<li>left</li>
<li>bottom</li>
<li>right</li>
</ul>
<p>如果某个维度坐标空着不指定，就可以得到“无限”Box。例如，不指定top，Box将一直延伸到绘图区域的顶部，无论发生任何平移或缩放。</p>
<p>让我们来看一个示例，在图中添加一些阴影框：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> bokeh.models.annotations <span class="keyword">import</span> BoxAnnotation</span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">20</span>, <span class="number">200</span>)</span><br><span class="line">y = np.sin(x)</span><br><span class="line"></span><br><span class="line">p = figure(y_range=(<span class="number">-2</span>, <span class="number">2</span>))</span><br><span class="line">p.line(x, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># region that always fills the top of the plot</span></span><br><span class="line">upper = BoxAnnotation(bottom=<span class="number">1</span>, fill_alpha=<span class="number">0.1</span>, fill_color=<span class="string">'olive'</span>)</span><br><span class="line">p.add_layout(upper)</span><br><span class="line"></span><br><span class="line"><span class="comment"># region that always fills the bottom of the plot</span></span><br><span class="line">lower = BoxAnnotation(top=<span class="number">-1</span>, fill_alpha=<span class="number">0.1</span>, fill_color=<span class="string">'firebrick'</span>)</span><br><span class="line">p.add_layout(lower)</span><br><span class="line"></span><br><span class="line"><span class="comment"># a finite region</span></span><br><span class="line">center = BoxAnnotation(top=<span class="number">0.6</span>, bottom=<span class="number">-0.3</span>, left=<span class="number">7</span>, right=<span class="number">12</span>, fill_alpha=<span class="number">0.1</span>, fill_color=<span class="string">'navy'</span>)</span><br><span class="line">p.add_layout(center)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="b785c0a8-85ca-450d-9f3a-7dad0ef452c4" data-root-id="44437"></div>





<h2 id="Label（标签）"><a href="#Label（标签）" class="headerlink" title="Label（标签）"></a>Label（标签）</h2><p>Label注释允许您轻松地绘图中添加单个文本标签。要显示的位置和文本被通过x, y和text设置：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Label(x=<span class="number">10</span>, y=<span class="number">5</span>, text=<span class="string">"Some Label"</span>)</span><br></pre></td></tr></table></figure><br>默认单位是“data space”，但x_units和y_units可以设置为”screen”来用相对位置定位标签。标签还可以用x_offset和y_offset来设置相对于x和y的偏移距离以确定最终位置。</p>
<p>Label对象具备标准的text，line（border_line）和fill（background_fill）属性。line和fill属性应用于文本周围的边界框：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Label(x=<span class="number">10</span>, y=<span class="number">5</span>, text=<span class="string">"Some Label"</span>, text_font_size=<span class="string">"12pt"</span>, </span><br><span class="line">      border_line_color=<span class="string">"red"</span>, background_fill_color=<span class="string">"blue"</span>)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models.annotations <span class="keyword">import</span> Label</span><br><span class="line"><span class="keyword">from</span> bokeh.plotting <span class="keyword">import</span> figure</span><br><span class="line"></span><br><span class="line">p = figure(x_range=(<span class="number">0</span>,<span class="number">10</span>), y_range=(<span class="number">0</span>,<span class="number">10</span>))</span><br><span class="line">p.circle([<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>], [<span class="number">4</span>, <span class="number">7</span>, <span class="number">6</span>], color=<span class="string">"olive"</span>, size=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">label = Label(x=<span class="number">5</span>, y=<span class="number">7</span>, x_offset=<span class="number">12</span>, text=<span class="string">"Second Point"</span>, text_baseline=<span class="string">"middle"</span>) <span class="comment">#offset</span></span><br><span class="line">p.add_layout(label)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="61966b39-80f8-4bec-a765-4a31eb68fc54" data-root-id="45360"></div>





<h2 id="LabelSet（标签集）"><a href="#LabelSet（标签集）" class="headerlink" title="LabelSet（标签集）"></a>LabelSet（标签集）</h2><p>LabelSet注释允许您一次创建许多标签，例如，给一系列标记符号创建标签注释。其与Label类似，不同之处是接受ColumnDataSource类型数据为 source属性，而且x和y指向数据源的列，例如x=”col2”（但也可以是固定值，如x=10）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> ColumnDataSource, LabelSet</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">source = ColumnDataSource(data=dict(</span><br><span class="line">    temp=[<span class="number">166</span>, <span class="number">171</span>, <span class="number">172</span>, <span class="number">168</span>, <span class="number">174</span>, <span class="number">162</span>],</span><br><span class="line">    pressure=[<span class="number">165</span>, <span class="number">189</span>, <span class="number">220</span>, <span class="number">141</span>, <span class="number">260</span>, <span class="number">174</span>],</span><br><span class="line">    names=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>]))</span><br><span class="line"></span><br><span class="line">p = figure(x_range=(<span class="number">160</span>, <span class="number">175</span>))</span><br><span class="line">p.scatter(x=<span class="string">'temp'</span>, y=<span class="string">'pressure'</span>, size=<span class="number">8</span>, source=source)</span><br><span class="line">p.xaxis.axis_label = <span class="string">'Temperature (C)'</span></span><br><span class="line">p.yaxis.axis_label = <span class="string">'Pressure (lbs)'</span></span><br><span class="line"></span><br><span class="line">labels = LabelSet(x=<span class="string">'temp'</span>, y=<span class="string">'pressure'</span>, text=<span class="string">'names'</span>, level=<span class="string">'glyph'</span>,</span><br><span class="line">                  x_offset=<span class="number">5</span>, y_offset=<span class="number">5</span>, source=source, render_mode=<span class="string">'canvas'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.add_layout(labels)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="10833f88-b89a-4814-8d8f-0d198a190935" data-root-id="46291"></div>





<h2 id="Arrows-箭头"><a href="#Arrows-箭头" class="headerlink" title="Arrows(箭头)"></a>Arrows(箭头)</h2><p>Arrow 注释允许您在图中 “指向” 不同的东西，而且结合 label 标签使用特别有用。</p>
<p>例如，创建一个箭头，从点（0,0）指向点（1,1）：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.add_layout(Arrow(x_start=<span class="number">0</span>, y_start=<span class="number">0</span>, x_end=<span class="number">1</span>, y_end=<span class="number">0</span>))</span><br></pre></td></tr></table></figure><br>这个箭头是缺省的指向箭头尾端的 OpenHead 箭头。其他种类的箭头包括 NormalHead 和 VeeHead。箭头头部类型可以通过设置 Arrow 对象的 start 和 end 属性设置：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p.add_layout(Arrow(start=OpenHead(), end=VeeHead(), </span><br><span class="line">             x_start=<span class="number">0</span>, y_start=<span class="number">0</span>, x_end=<span class="number">1</span>, y_end=<span class="number">0</span>))</span><br></pre></td></tr></table></figure><br>这将创建一个双端箭头，箭头是“open”类型，箭尾是“Vee”类型。箭头部可通过line和fill的标准属性设置来控制其外观。看一个例子</p>
<p><code>OpenHead(line_color=&quot;firebrick&quot;, line_width=4)</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models.annotations <span class="keyword">import</span> Arrow</span><br><span class="line"><span class="keyword">from</span> bokeh.models.arrow_heads <span class="keyword">import</span> OpenHead, NormalHead, VeeHead</span><br><span class="line"></span><br><span class="line">p = figure(plot_width=<span class="number">600</span>, plot_height=<span class="number">600</span>)</span><br><span class="line"></span><br><span class="line">p.circle(x=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0.5</span>], y=[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.7</span>], radius=<span class="number">0.1</span>,</span><br><span class="line">         color=[<span class="string">"navy"</span>, <span class="string">"yellow"</span>, <span class="string">"red"</span>], fill_alpha=<span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">p.add_layout(Arrow(end=OpenHead(line_color=<span class="string">"firebrick"</span>, line_width=<span class="number">4</span>),</span><br><span class="line">                   x_start=<span class="number">0</span>, y_start=<span class="number">0</span>, x_end=<span class="number">1</span>, y_end=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">p.add_layout(Arrow(end=NormalHead(fill_color=<span class="string">"orange"</span>),</span><br><span class="line">                   x_start=<span class="number">1</span>, y_start=<span class="number">0</span>, x_end=<span class="number">0.5</span>, y_end=<span class="number">0.7</span>))</span><br><span class="line"></span><br><span class="line">p.add_layout(Arrow(end=VeeHead(size=<span class="number">35</span>), line_color=<span class="string">"red"</span>,</span><br><span class="line">                   x_start=<span class="number">0.5</span>, y_start=<span class="number">0.7</span>, x_end=<span class="number">0</span>, y_end=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="e7178458-c5f9-42f6-8dac-bad758fe93d1" data-root-id="47231"></div>





<h2 id="Legends-图例"><a href="#Legends-图例" class="headerlink" title="Legends(图例)"></a>Legends(图例)</h2><h3 id="Simple-Legends-简单图例"><a href="#Simple-Legends-简单图例" class="headerlink" title="Simple Legends(简单图例)"></a>Simple Legends(简单图例)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">4</span>*np.pi, <span class="number">100</span>)</span><br><span class="line">y = np.sin(x)</span><br><span class="line"></span><br><span class="line">p = figure(height=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">p.circle(x, y, legend=<span class="string">"sin(x)"</span>)</span><br><span class="line">p.line(x, <span class="number">2</span>*y, legend=<span class="string">"2*sin(x)"</span>, line_dash=[<span class="number">4</span>, <span class="number">4</span>], line_color=<span class="string">"orange"</span>, line_width=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<pre><code>BokehDeprecationWarning: &#39;legend&#39; keyword is deprecated, use explicit &#39;legend_label&#39;, &#39;legend_field&#39;, or &#39;legend_group&#39; keywords instead
BokehDeprecationWarning: &#39;legend&#39; keyword is deprecated, use explicit &#39;legend_label&#39;, &#39;legend_field&#39;, or &#39;legend_group&#39; keywords instead
</code></pre><div class="bk-root" id="f68b5b9f-1ef2-4a55-babd-fb33b758d655" data-root-id="48187"></div>





<h2 id="Color-bars（彩色柱状图）"><a href="#Color-bars（彩色柱状图）" class="headerlink" title="Color bars（彩色柱状图）"></a>Color bars（彩色柱状图）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.sampledata.autompg <span class="keyword">import</span> autompg</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> LinearColorMapper, ColorBar</span><br><span class="line"><span class="keyword">from</span> bokeh.palettes <span class="keyword">import</span> Viridis256</span><br><span class="line"></span><br><span class="line">source = ColumnDataSource(autompg)</span><br><span class="line">color_mapper = LinearColorMapper(palette=Viridis256, low=autompg.weight.min(), high=autompg.weight.max())</span><br><span class="line"></span><br><span class="line">p = figure(x_axis_label=<span class="string">'Year'</span>, y_axis_label=<span class="string">'MPG'</span>, tools=<span class="string">''</span>, toolbar_location=<span class="string">'above'</span>)</span><br><span class="line">p.circle(x=<span class="string">'yr'</span>, y=<span class="string">'mpg'</span>, color=&#123;<span class="string">'field'</span>: <span class="string">'weight'</span>, <span class="string">'transform'</span>: color_mapper&#125;, size=<span class="number">20</span>, alpha=<span class="number">0.6</span>, source=source)</span><br><span class="line"></span><br><span class="line">color_bar = ColorBar(color_mapper=color_mapper, label_standoff=<span class="number">12</span>, location=(<span class="number">0</span>,<span class="number">0</span>), title=<span class="string">'Weight'</span>)</span><br><span class="line">p.add_layout(color_bar, <span class="string">'right'</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="30f8b5eb-602b-48ea-82e5-fec15521ba81" data-root-id="49187"></div>





<h1 id="数据源和数据转换"><a href="#数据源和数据转换" class="headerlink" title="数据源和数据转换"></a>数据源和数据转换</h1><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>我们已经看到Bokeh怎么能够很好地与Python列表、NumPy数组、Pandas序列一起工作。在底层，这些输入数据被转换为Bokeh的ColumnDataSource类型。这个数据类型是Bokeh使用的核心数据源对象。虽然Bokeh经常通过透明的方式创建该类型对象，但有些时候也需要通过显式的方式创建。</p>
<h2 id="创建数据源"><a href="#创建数据源" class="headerlink" title="创建数据源"></a>创建数据源</h2><h3 id="通过-Python-Dicts-创建"><a href="#通过-Python-Dicts-创建" class="headerlink" title="通过 Python Dicts 创建"></a>通过 Python Dicts 创建</h3><p>从 bokeh.models 导入 ColumnDataSource：</p>
<p><code>from bokeh.models import ColumnDataSource</code></p>
<p>ColumnDataSource是从列名（字符串）到值序列的映射。下面是一个简单的例子。映射是通过传入Python dict建立的，其字符串键作为列名，对应的Python list作为值序列。该值序列也可以是NumPy数组，或Pandas序列。</p>
<p><strong>注意：ColumnDataSource 中所有的列必须等长。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">source = ColumnDataSource(data=&#123;</span><br><span class="line">    <span class="string">'x'</span> : [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">    <span class="string">'y'</span> : [<span class="number">3</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">1</span>],</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>到目前，我们已经通过直接传入文本列表或数组数据的方式调用函数，如p.circle。当我们这样做时，Bokeh会自动帮我们创建一个 ColumnDataSource。但我们也可以显式地把 ColumnDataSource 作为 source 参数传入glyph函数。当我们这样做时，如果我们想要给一个属性（如”x” 或 “y” 或 “fill_color”）指定一个值序列，我们传入对应的列名：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.circle(<span class="string">'x'</span>, <span class="string">'y'</span>, size=<span class="number">20</span>, source=source)</span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="c9aeee1d-bca0-43c1-87d7-4d8caeb50089" data-root-id="50150"></div>





<h3 id="通过-Pandas-DataFrames-创建"><a href="#通过-Pandas-DataFrames-创建" class="headerlink" title="通过 Pandas DataFrames 创建"></a>通过 Pandas DataFrames 创建</h3><p>通过Pandas Dataframe创建 ColumnDataSource 对象也很容易。只需要在创建 ColumnDataSource 的时候把Dataframe传入就行：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.sampledata.iris <span class="keyword">import</span> flowers <span class="keyword">as</span> df</span><br><span class="line"></span><br><span class="line">source = ColumnDataSource(df)</span><br></pre></td></tr></table></figure>
<p>现在我们就可以使用这个对象绘制上例中的图了，把对应的列名传入glyph函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">p.circle(<span class="string">'petal_length'</span>, <span class="string">'petal_width'</span>, source=source)</span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="1d384062-0d46-409c-b76c-30d5a6543cf8" data-root-id="51128"></div>





<h2 id="转换数据"><a href="#转换数据" class="headerlink" title="转换数据"></a>转换数据</h2><h3 id="标记"><a href="#标记" class="headerlink" title="标记"></a>标记</h3><p>还可以将分类数据映射到标记类型。下面的示例展示了如何使用factor_mark()在输入数据中显示不同的标记或不同的类别。它还演示了使用factor_cmap()对相同的类别进行着色:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.transform <span class="keyword">import</span> factor_cmap, factor_mark</span><br><span class="line"><span class="keyword">from</span> bokeh.sampledata.iris <span class="keyword">import</span> flowers</span><br><span class="line">SPECIES = [<span class="string">'setosa'</span>, <span class="string">'versicolor'</span>, <span class="string">'virginica'</span>]</span><br><span class="line">MARKERS = [<span class="string">'hex'</span>, <span class="string">'circle_x'</span>, <span class="string">'triangle'</span>]</span><br><span class="line"></span><br><span class="line">p = figure(title = <span class="string">"Iris Morphology"</span>)</span><br><span class="line">p.xaxis.axis_label = <span class="string">'Petal Length'</span></span><br><span class="line">p.yaxis.axis_label = <span class="string">'Sepal Width'</span></span><br><span class="line"></span><br><span class="line">p.scatter(<span class="string">"petal_length"</span>, <span class="string">"sepal_width"</span>, source=flowers, legend_field=<span class="string">"species"</span>, fill_alpha=<span class="number">0.4</span>, size=<span class="number">12</span>,</span><br><span class="line">          marker=factor_mark(<span class="string">'species'</span>, MARKERS, SPECIES),</span><br><span class="line">          color=factor_cmap(<span class="string">'species'</span>, <span class="string">'Category10_3'</span>, SPECIES))</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="07ee8725-f742-4185-88cd-45a80629c6c2" data-root-id="52114"></div>





<p>factor_mark()转换主要只对散点符号方法有用，因为只有散点符号可以由标记类型参数化。</p>
<h3 id="自定义JS变换"><a href="#自定义JS变换" class="headerlink" title="自定义JS变换"></a>自定义JS变换</h3><p>除了上面的内置转换之外，还有一个CustomJSTransform，它允许指定任意的JavaScript代码来执行对ColumnDataSource数据的转换步骤。通常会提供v_func(用于“向量化”函数)(更不常见的情况是，可能还需要一个等价的标量func)。v_func代码应该期望变量xs中的一个输入数组，并返回一个JavaScript数组，其中包含转换后的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#v_func = """</span></span><br><span class="line"><span class="comment">#    const first = xs[0]</span></span><br><span class="line"><span class="comment">#    const norm = new Float64Array(xs.length)</span></span><br><span class="line"><span class="comment">#    for (let i = 0; i &lt; xs.length; i++) &#123;</span></span><br><span class="line"><span class="comment">#        norm[i] = xs[i] / first</span></span><br><span class="line"><span class="comment">#    &#125;</span></span><br><span class="line"><span class="comment">#    return norm</span></span><br><span class="line"><span class="comment">#"""</span></span><br><span class="line"><span class="comment">#normalize = CustomJSTransform(v_func=v_func)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#plot.line(x='aapl_date', y=transform('aapl_close', normalize), line_width=2,</span></span><br><span class="line"><span class="comment">#          color='#cf3c4d', alpha=0.6,legend="Apple", source=aapl_source)</span></span><br></pre></td></tr></table></figure>
<h2 id="过滤数据"><a href="#过滤数据" class="headerlink" title="过滤数据"></a>过滤数据</h2><p>通常需要关注已从较大数据集下采样或过滤的数据的一部分。bokeh允许您指定表示数据子集的数据源的视图。通过拥有数据源的视图，底层数据不需要更改，并且可以在图之间共享。视图由一个或多个筛选器组成，这些筛选器选择应绑定到特定符号的数据源行。</p>
<p>要使用数据子集进行绘图，可以创建一个CDSView，并将其作为视图参数传递给图形上的呈现器添加方法，如Figure .circle。CDSView有两个属性，源和过滤器。source是与视图关联的ColumnDataSource。过滤器是过滤器对象的列表，下面列出并描述。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> ColumnDataSource, CDSView</span><br><span class="line"></span><br><span class="line">source = ColumnDataSource(some_data)</span><br><span class="line">view = CDSView(source=source, filters=[filter1, filter2])</span><br><span class="line"></span><br><span class="line">p = figure()</span><br><span class="line">p.circle(x=<span class="string">"x"</span>, y=<span class="string">"y"</span>, source=source, view=view)</span><br></pre></td></tr></table></figure></p>
<h3 id="索引过滤"><a href="#索引过滤" class="headerlink" title="索引过滤"></a>索引过滤</h3><p>IndexFilter是最简单的过滤器类型。它有一个索引属性，它是一个整数列表，这些整数是你想要包含在图中的数据的索引。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.layouts <span class="keyword">import</span> gridplot</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CDSView, ColumnDataSource, IndexFilter</span><br><span class="line"></span><br><span class="line">source = ColumnDataSource(data=dict(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]))</span><br><span class="line">view = CDSView(source=source, filters=[IndexFilter([<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>])])</span><br><span class="line"></span><br><span class="line">tools = [<span class="string">"box_select"</span>, <span class="string">"hover"</span>, <span class="string">"reset"</span>]</span><br><span class="line">p = figure(plot_height=<span class="number">300</span>, plot_width=<span class="number">300</span>, tools=tools)</span><br><span class="line">p.circle(x=<span class="string">"x"</span>, y=<span class="string">"y"</span>, size=<span class="number">10</span>, hover_color=<span class="string">"red"</span>, source=source)</span><br><span class="line"></span><br><span class="line">p_filtered = figure(plot_height=<span class="number">300</span>, plot_width=<span class="number">300</span>, tools=tools)</span><br><span class="line">p_filtered.circle(x=<span class="string">"x"</span>, y=<span class="string">"y"</span>, size=<span class="number">10</span>, hover_color=<span class="string">"red"</span>, source=source, view=view)</span><br><span class="line"></span><br><span class="line">show(gridplot([[p, p_filtered]]))</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="ded90fde-622a-419c-bbbe-a2a4fdb1f533" data-root-id="53204"></div>





<h3 id="布尔过滤器"><a href="#布尔过滤器" class="headerlink" title="布尔过滤器"></a>布尔过滤器</h3><p>布尔过滤器通过其布尔值属性中的真值或假值列表从数据源中选择行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> BooleanFilter, CDSView, ColumnDataSource</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">source = ColumnDataSource(data=dict(x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], y=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]))</span><br><span class="line">booleans = [<span class="literal">True</span> <span class="keyword">if</span> y_val &gt; <span class="number">2</span> <span class="keyword">else</span> <span class="literal">False</span> <span class="keyword">for</span> y_val <span class="keyword">in</span> source.data[<span class="string">'y'</span>]]</span><br><span class="line">view = CDSView(source=source, filters=[BooleanFilter(booleans)])</span><br><span class="line"></span><br><span class="line">tools = [<span class="string">"box_select"</span>, <span class="string">"hover"</span>, <span class="string">"reset"</span>]</span><br><span class="line">p = figure(plot_height=<span class="number">300</span>, plot_width=<span class="number">300</span>, tools=tools)</span><br><span class="line">p.circle(x=<span class="string">"x"</span>, y=<span class="string">"y"</span>, size=<span class="number">10</span>, hover_color=<span class="string">"red"</span>, source=source)</span><br><span class="line"></span><br><span class="line">p_filtered = figure(plot_height=<span class="number">300</span>, plot_width=<span class="number">300</span>, tools=tools,</span><br><span class="line">                    x_range=p.x_range, y_range=p.y_range)</span><br><span class="line">p_filtered.circle(x=<span class="string">"x"</span>, y=<span class="string">"y"</span>, size=<span class="number">10</span>, hover_color=<span class="string">"red"</span>, source=source, view=view)</span><br><span class="line"></span><br><span class="line">show(gridplot([[p, p_filtered]]))</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="6dd206ab-cb6e-4419-b773-ff8d33c5a107" data-root-id="54308"></div>





<h3 id="群滤波器"><a href="#群滤波器" class="headerlink" title="群滤波器"></a>群滤波器</h3><p>GroupFilter允许您从数据集中选择具有分类变量特定值的行。GroupFilter有两个属性，column_name (ColumnDataSource中的列名称)和group(要选择的列的值)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.layouts <span class="keyword">import</span> gridplot</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CDSView, ColumnDataSource, GroupFilter</span><br><span class="line"><span class="keyword">from</span> bokeh.sampledata.iris <span class="keyword">import</span> flowers</span><br><span class="line"></span><br><span class="line">source = ColumnDataSource(flowers)</span><br><span class="line">view1 = CDSView(source=source, filters=[GroupFilter(column_name=<span class="string">'species'</span>, group=<span class="string">'versicolor'</span>)])</span><br><span class="line"></span><br><span class="line">plot_size_and_tools = &#123;<span class="string">'plot_height'</span>: <span class="number">300</span>, <span class="string">'plot_width'</span>: <span class="number">300</span>,</span><br><span class="line">                        <span class="string">'tools'</span>:[<span class="string">'box_select'</span>, <span class="string">'reset'</span>, <span class="string">'help'</span>]&#125;</span><br><span class="line"></span><br><span class="line">p1 = figure(title=<span class="string">"Full data set"</span>, **plot_size_and_tools)</span><br><span class="line">p1.circle(x=<span class="string">'petal_length'</span>, y=<span class="string">'petal_width'</span>, source=source, color=<span class="string">'black'</span>)</span><br><span class="line"></span><br><span class="line">p2 = figure(title=<span class="string">"Setosa only"</span>, x_range=p1.x_range, y_range=p1.y_range, **plot_size_and_tools)</span><br><span class="line">p2.circle(x=<span class="string">'petal_length'</span>, y=<span class="string">'petal_width'</span>, source=source, view=view1, color=<span class="string">'red'</span>)</span><br><span class="line"></span><br><span class="line">show(gridplot([[p1, p2]]))</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="31c2d478-9e2b-42b7-b07c-4a2e0a4a0888" data-root-id="55428"></div>





<h1 id="演示布局"><a href="#演示布局" class="headerlink" title="演示布局"></a>演示布局</h1><p>在前面的章节中，我们学习了如何使用不同类型的数据创建单个图表。但我们经常想绘制不止一幅图。Bokeh 图表可以单独嵌入在HTML文件中，但把多个图表合并在一个Bokeh内置的Layout里也是很容易的。我们将在本章学习如何做到这一点。</p>
<p>下面的单元格定义了一些我们将在示例中使用的数据变量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = list(range(<span class="number">11</span>))</span><br><span class="line">y0, y1, y2 = x, [<span class="number">10</span>-i <span class="keyword">for</span> i <span class="keyword">in</span> x], [abs(i<span class="number">-5</span>) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br></pre></td></tr></table></figure>
<h2 id="行与列"><a href="#行与列" class="headerlink" title="行与列"></a>行与列</h2><p>bokeh.layouts 模块提供了 row 和 column 功能以便在垂直和水平布局中排列图表。下面的例子把三个图表排成一排。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.layouts <span class="keyword">import</span> row </span><br><span class="line"></span><br><span class="line"><span class="comment"># create a new plot</span></span><br><span class="line">s1 = figure(width=<span class="number">250</span>, plot_height=<span class="number">250</span>)</span><br><span class="line">s1.circle(x, y0, size=<span class="number">10</span>, color=<span class="string">"navy"</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create another one</span></span><br><span class="line">s2 = figure(width=<span class="number">250</span>, height=<span class="number">250</span>)</span><br><span class="line">s2.triangle(x, y1, size=<span class="number">10</span>, color=<span class="string">"firebrick"</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create and another</span></span><br><span class="line">s3 = figure(width=<span class="number">250</span>, height=<span class="number">250</span>)</span><br><span class="line">s3.square(x, y2, size=<span class="number">10</span>, color=<span class="string">"olive"</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># show the results in a row</span></span><br><span class="line">show(row(s1, s2, s3))</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="47c03652-8025-497b-bd1c-fad86bf0e583" data-root-id="56573"></div>





<h2 id="Grids-Layout-for-Plots-网格布局"><a href="#Grids-Layout-for-Plots-网格布局" class="headerlink" title="Grids Layout for Plots(网格布局)"></a>Grids Layout for Plots(网格布局)</h2><p>gridplot()函数可用于在网格布局中安排散景图。gridplot()还将所有工具收集到一个工具栏中，当前活动的工具对于网格中的所有绘图都是相同的。通过传递None而不是plot对象，可以在网格中留下“ ”空间。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.layouts <span class="keyword">import</span> gridplot</span><br><span class="line">x = list(range(<span class="number">11</span>))</span><br><span class="line">y0 = x</span><br><span class="line">y1 = [<span class="number">10</span> - i <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line">y2 = [abs(i - <span class="number">5</span>) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line"><span class="comment"># create three plots</span></span><br><span class="line">s1 = figure(background_fill_color=<span class="string">"#fafafa"</span>)</span><br><span class="line">s1.circle(x, y0, size=<span class="number">12</span>, alpha=<span class="number">0.8</span>, color=<span class="string">"#53777a"</span>)</span><br><span class="line"></span><br><span class="line">s2 = figure(background_fill_color=<span class="string">"#fafafa"</span>)</span><br><span class="line">s2.triangle(x, y1, size=<span class="number">12</span>, alpha=<span class="number">0.8</span>, color=<span class="string">"#c02942"</span>)</span><br><span class="line"></span><br><span class="line">s3 = figure(background_fill_color=<span class="string">"#fafafa"</span>)</span><br><span class="line">s3.square(x, y2, size=<span class="number">12</span>, alpha=<span class="number">0.8</span>, color=<span class="string">"#d95b43"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make a grid</span></span><br><span class="line">grid = gridplot([[s1, s2], [<span class="literal">None</span>, s3]], plot_width=<span class="number">250</span>, plot_height=<span class="number">250</span>)</span><br><span class="line"></span><br><span class="line">show(grid)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="1bcd6b41-6321-493b-9c7a-11c78465ad9a" data-root-id="57854"></div>





<p>为了方便，您还可以传递一个绘图列表，并指定网格中所需的列数。例如</p>
<p><code>gridplot([s1, s2, s3], ncols=2)</code></p>
<p>默认情况下，gridplot将把每个子图中的所有工具合并到一个附加到网格的工具栏中。要禁用此行为，可以将选项merge_tools设置为False。</p>
<h2 id="Sizing-Mode"><a href="#Sizing-Mode" class="headerlink" title="Sizing Mode"></a>Sizing Mode</h2><h3 id="Modes"><a href="#Modes" class="headerlink" title="Modes"></a>Modes</h3><p>可布图散景对象可使用以下大小调整模式单独配置:<br><strong>“fixed”</strong><br>组件没有响应。它将保持其原始的宽度和高度，而不管随后的任何浏览器窗口调整事件。</p>
<p><strong>“stretch_width”</strong><br>组件将响应地调整大小以拉伸到可用的宽度，而不保持任何长宽比。组件的高度取决于组件的类型，可以是固定的，也可以适合组件的内容。</p>
<p><strong>“stretch_height”</strong><br>组件将响应地调整大小以拉伸到可用的高度，而不保持任何宽高比。组件的宽度取决于组件的类型，可以是固定的，也可以适合组件的内容。</p>
<p><strong>“stretch_both”</strong><br>组件是完全响应，独立的宽度和高度，并将占据所有可用的水平和垂直空间，即使这改变了高宽比的组件。</p>
<p><strong>“scale_width”</strong><br>组件将响应地调整大小以拉伸到可用宽度，同时保持原始或提供的高宽比。</p>
<p><strong>“scale_height”</strong><br>组件将响应地调整大小以拉伸到可用的高度，同时保持原始或提供的高宽比。</p>
<p><strong>“scale_both”</strong><br>组件将响应调整大小到可用的宽度和高度，同时保持原始或提供的高宽比。</p>
<p>一般来说，根据模式的不同，宽度和高度可能需要同时提供其中之一或两者。(例如，对于stretch_width模式，必须提供所需的固定高度)。</p>
<p>注意，诸如行和列之类的布局对象将把它们配置的大小调整模式传递给它们自己没有显式设置sizing_mode的任何子对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">100</span>)</span><br><span class="line">y = np.sin(x)</span><br><span class="line"></span><br><span class="line">source = ColumnDataSource(data=dict(x=x, y=y))</span><br><span class="line"></span><br><span class="line">plot = figure(</span><br><span class="line">    y_range=(<span class="number">-10</span>, <span class="number">10</span>), tools=<span class="string">''</span>, toolbar_location=<span class="literal">None</span>,</span><br><span class="line">    title=<span class="string">"Sliders example"</span>)</span><br><span class="line">plot.line(<span class="string">'x'</span>, <span class="string">'y'</span>, source=source, line_width=<span class="number">3</span>, line_alpha=<span class="number">0.6</span>)</span><br><span class="line"></span><br><span class="line">amp_slider = Slider(start=<span class="number">0.1</span>, end=<span class="number">10</span>, value=<span class="number">1</span>, step=<span class="number">.1</span>, title=<span class="string">"Amplitude"</span>)</span><br><span class="line">freq_slider = Slider(start=<span class="number">0.1</span>, end=<span class="number">10</span>, value=<span class="number">1</span>, step=<span class="number">.1</span>, title=<span class="string">"Frequency"</span>)</span><br><span class="line">phase_slider = Slider(start=<span class="number">0</span>, end=<span class="number">6.4</span>, value=<span class="number">0</span>, step=<span class="number">.1</span>, title=<span class="string">"Phase"</span>)</span><br><span class="line">offset_slider = Slider(start=<span class="number">-5</span>, end=<span class="number">5</span>, value=<span class="number">0</span>, step=<span class="number">.1</span>, title=<span class="string">"Offset"</span>)</span><br><span class="line"></span><br><span class="line">callback = CustomJS(args=dict(source=source, amp=amp_slider, freq=freq_slider, phase=phase_slider, offset=offset_slider),</span><br><span class="line">                    code=<span class="string">"""</span></span><br><span class="line"><span class="string">    const data = source.data;</span></span><br><span class="line"><span class="string">    const A = amp.value;</span></span><br><span class="line"><span class="string">    const k = freq.value;</span></span><br><span class="line"><span class="string">    const phi = phase.value;</span></span><br><span class="line"><span class="string">    const B = offset.value;</span></span><br><span class="line"><span class="string">    const x = data['x']</span></span><br><span class="line"><span class="string">    const y = data['y']</span></span><br><span class="line"><span class="string">    for (var i = 0; i &lt; x.length; i++) &#123;</span></span><br><span class="line"><span class="string">        y[i] = B + A*Math.sin(k*x[i]+phi);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    source.change.emit();</span></span><br><span class="line"><span class="string">"""</span>)</span><br><span class="line"></span><br><span class="line">amp_slider.js_on_change(<span class="string">'value'</span>, callback)</span><br><span class="line">freq_slider.js_on_change(<span class="string">'value'</span>, callback)</span><br><span class="line">phase_slider.js_on_change(<span class="string">'value'</span>, callback)</span><br><span class="line">offset_slider.js_on_change(<span class="string">'value'</span>, callback)</span><br><span class="line"></span><br><span class="line">widgets = column(amp_slider, freq_slider, phase_slider, offset_slider)</span><br><span class="line">show(row(widgets, plot))</span><br></pre></td></tr></table></figure>
<pre><code>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

&lt;ipython-input-113-9b31cc8e3ab2&gt; in &lt;module&gt;
      9 plot.line(&#39;x&#39;, &#39;y&#39;, source=source, line_width=3, line_alpha=0.6)
     10 
---&gt; 11 amp_slider = Slider(start=0.1, end=10, value=1, step=.1, title=&quot;Amplitude&quot;)
     12 freq_slider = Slider(start=0.1, end=10, value=1, step=.1, title=&quot;Frequency&quot;)
     13 phase_slider = Slider(start=0, end=6.4, value=0, step=.1, title=&quot;Phase&quot;)


NameError: name &#39;Slider&#39; is not defined
</code></pre><h1 id="关联和交互"><a href="#关联和交互" class="headerlink" title="关联和交互"></a>关联和交互</h1><h2 id="链接的行为"><a href="#链接的行为" class="headerlink" title="链接的行为"></a>链接的行为</h2><p>链接图以增加图之间的交互性通常很有用。</p>
<h3 id="链接平移"><a href="#链接平移" class="headerlink" title="链接平移"></a>链接平移</h3><p>通常需要在多个情节中链接平移或缩放动作。要启用此特性，只需在plot()调用之间共享range对象。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.layouts <span class="keyword">import</span> gridplot</span><br><span class="line">x = list(range(<span class="number">11</span>))</span><br><span class="line">y0 = x</span><br><span class="line">y1 = [<span class="number">10</span>-xx <span class="keyword">for</span> xx <span class="keyword">in</span> x]</span><br><span class="line">y2 = [abs(xx<span class="number">-5</span>) <span class="keyword">for</span> xx <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line"><span class="comment"># create a new plot</span></span><br><span class="line">s1 = figure(plot_width=<span class="number">250</span>, plot_height=<span class="number">250</span>, title=<span class="literal">None</span>)</span><br><span class="line">s1.circle(x, y0, size=<span class="number">10</span>, color=<span class="string">"navy"</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create a new plot and share both ranges</span></span><br><span class="line">s2 = figure(plot_width=<span class="number">250</span>, plot_height=<span class="number">250</span>, x_range=s1.x_range, y_range=s1.y_range, title=<span class="literal">None</span>)</span><br><span class="line">s2.triangle(x, y1, size=<span class="number">10</span>, color=<span class="string">"firebrick"</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create a new plot and share only one range</span></span><br><span class="line">s3 = figure(plot_width=<span class="number">250</span>, plot_height=<span class="number">250</span>, x_range=s1.x_range, title=<span class="literal">None</span>)</span><br><span class="line">s3.square(x, y2, size=<span class="number">10</span>, color=<span class="string">"olive"</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">p = gridplot([[s1, s2, s3]], toolbar_location=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># show the results</span></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="1c77d21d-9c9a-4421-80dd-1d101f1b6853" data-root-id="59182"></div>





<h3 id="链接选择"><a href="#链接选择" class="headerlink" title="链接选择"></a>链接选择</h3><p>在bokeh中链接刷是通过在函数渲染器之间共享数据源来表达的。这就是bokeh所需要理解的，在一个函数上操作的选择必须传递给共享同一源的所有其他函数。要了解链接选择如何扩展到只绘制来自数据源的数据子集的函数呈现器，请参阅<a href="https://docs.bokeh.org/en/latest/docs/user_guide/data.html#userguide-data-linked-selection-with-filtering" target="_blank" rel="noopener">带过滤数据的链接选择</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.layouts <span class="keyword">import</span> gridplot</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> ColumnDataSource</span><br><span class="line"><span class="keyword">from</span> bokeh.plotting <span class="keyword">import</span> figure</span><br><span class="line"></span><br><span class="line">x = list(range(<span class="number">-20</span>, <span class="number">21</span>))</span><br><span class="line">y0 = [abs(xx) <span class="keyword">for</span> xx <span class="keyword">in</span> x]</span><br><span class="line">y1 = [xx**<span class="number">2</span> <span class="keyword">for</span> xx <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line"><span class="comment"># create a column data source for the plots to share</span></span><br><span class="line">source = ColumnDataSource(data=dict(x=x, y0=y0, y1=y1))</span><br><span class="line"></span><br><span class="line">TOOLS = <span class="string">"box_select,lasso_select,reset,help"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># create a new plot and add a renderer</span></span><br><span class="line">left = figure(tools=TOOLS, plot_width=<span class="number">300</span>, plot_height=<span class="number">300</span>, title=<span class="literal">None</span>)</span><br><span class="line">left.circle(<span class="string">'x'</span>, <span class="string">'y0'</span>, source=source)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create another new plot and add a renderer</span></span><br><span class="line">right = figure(tools=TOOLS, plot_width=<span class="number">300</span>, plot_height=<span class="number">300</span>, title=<span class="literal">None</span>)</span><br><span class="line">right.circle(<span class="string">'x'</span>, <span class="string">'y1'</span>, source=source)</span><br><span class="line"></span><br><span class="line">p = gridplot([[left, right]])</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="7265b1ad-556d-489c-8e71-104a2a80e490" data-root-id="60447"></div>





<h3 id="链接属性"><a href="#链接属性" class="headerlink" title="链接属性"></a>链接属性</h3><p>还可以使用js_link方法将Bokeh模型属性的值链接在一起，以便它们保持同步。下面的例子将一个圆形符号半径链接到一个滑块部件的值:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.layouts <span class="keyword">import</span> column</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> Slider</span><br><span class="line"></span><br><span class="line">plot = figure(plot_width=<span class="number">400</span>, plot_height=<span class="number">400</span>)</span><br><span class="line">r = plot.circle([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,], [<span class="number">3</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">4</span>], radius=<span class="number">0.2</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">slider = Slider(start=<span class="number">0.1</span>, end=<span class="number">2</span>, step=<span class="number">0.01</span>, value=<span class="number">0.2</span>)</span><br><span class="line">slider.js_link(<span class="string">'value'</span>, r.glyph, <span class="string">'radius'</span>)</span><br><span class="line"></span><br><span class="line">show(column(plot, slider))</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="83eddc0b-7712-4d10-a0a2-1a58a0760082" data-root-id="61628"></div>





<h2 id="图例交互"><a href="#图例交互" class="headerlink" title="图例交互"></a>图例交互</h2><p>添加到bokeh的图例可以进行交互，因此单击或轻击图例条目将隐藏或弱化图例中的相应符号。通过将图例上的click_policy属性设置为“隐藏”或“弱化”，可以激活这些模式。</p>
<h3 id="隐藏图例"><a href="#隐藏图例" class="headerlink" title="隐藏图例"></a>隐藏图例</h3><p>有时，我们希望能够通过单击图例中的条目来隐藏字形。在散景中，这可以通过将图例click_policy属性设置为“hide”来实现，如下例所示:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> bokeh.palettes <span class="keyword">import</span> Spectral4</span><br><span class="line"><span class="keyword">from</span> bokeh.sampledata.stocks <span class="keyword">import</span> AAPL, GOOG, IBM, MSFT</span><br><span class="line"></span><br><span class="line">p = figure(plot_width=<span class="number">800</span>, plot_height=<span class="number">250</span>, x_axis_type=<span class="string">"datetime"</span>)</span><br><span class="line">p.title.text = <span class="string">'Click on legend entries to hide the corresponding lines'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> data, name, color <span class="keyword">in</span> zip([AAPL, IBM, MSFT, GOOG], [<span class="string">"AAPL"</span>, <span class="string">"IBM"</span>, <span class="string">"MSFT"</span>, <span class="string">"GOOG"</span>], Spectral4):</span><br><span class="line">    df = pd.DataFrame(data)</span><br><span class="line">    df[<span class="string">'date'</span>] = pd.to_datetime(df[<span class="string">'date'</span>])</span><br><span class="line">    p.line(df[<span class="string">'date'</span>], df[<span class="string">'close'</span>], line_width=<span class="number">2</span>, color=color, alpha=<span class="number">0.8</span>, legend_label=name)</span><br><span class="line"></span><br><span class="line">p.legend.location = <span class="string">"top_left"</span></span><br><span class="line">p.legend.click_policy=<span class="string">"hide"</span></span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="a7aa8a1c-b719-4caf-84db-b1c00a01690c" data-root-id="62736"></div>





<p>其他时候，legend交互最好能弱化一个图形，而不是完全隐藏它。在本例中，将click_policy属性设置为“弱化”。此外，还需要指定“muted glyph”的视觉属性。通常，这与选中和未选中符号或悬停检查的方式完全相同。在下面的例子中，muted_alpha=0.2和muted_color=color被传递给circle，以指定哑线应该用低alpha哑线图形绘制。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> bokeh.palettes <span class="keyword">import</span> Spectral4</span><br><span class="line"><span class="keyword">from</span> bokeh.sampledata.stocks <span class="keyword">import</span> AAPL, GOOG, IBM, MSFT</span><br><span class="line"></span><br><span class="line">p = figure(plot_width=<span class="number">800</span>, plot_height=<span class="number">250</span>, x_axis_type=<span class="string">"datetime"</span>)</span><br><span class="line">p.title.text = <span class="string">'Click on legend entries to mute the corresponding lines'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> data, name, color <span class="keyword">in</span> zip([AAPL, IBM, MSFT, GOOG], [<span class="string">"AAPL"</span>, <span class="string">"IBM"</span>, <span class="string">"MSFT"</span>, <span class="string">"GOOG"</span>], Spectral4):</span><br><span class="line">    df = pd.DataFrame(data)</span><br><span class="line">    df[<span class="string">'date'</span>] = pd.to_datetime(df[<span class="string">'date'</span>])</span><br><span class="line">    p.line(df[<span class="string">'date'</span>], df[<span class="string">'close'</span>], line_width=<span class="number">2</span>, color=color, alpha=<span class="number">0.8</span>,</span><br><span class="line">           muted_color=color, muted_alpha=<span class="number">0.2</span>, legend_label=name)</span><br><span class="line"></span><br><span class="line">p.legend.location = <span class="string">"top_left"</span></span><br><span class="line">p.legend.click_policy=<span class="string">"mute"</span></span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="b95f32b8-6ed0-4e2d-b088-54af381914ca" data-root-id="64131"></div>





<h2 id="添加小部件"><a href="#添加小部件" class="headerlink" title="添加小部件"></a>添加小部件</h2><p>小部件是交互式控件，可以添加到散景应用程序中，为可视化提供前端用户界面。它们可以驱动新的计算、更新绘图并连接到其他编程功能。当与Bokeh服务器一起使用时，小部件可以运行任意的Python代码，从而支持复杂的应用程序。小部件也可以通过浏览器的Javascript运行时在独立的HTML文档中使用，而无需使用Bokeh服务器。</p>
<h3 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h3><p>要使用小部件，必须将它们添加到文档中并定义它们的回调。小部件可以直接添加到文档根中或嵌套在布局中。有两种使用小部件功能的方法:</p>
<ul>
<li>CustomJS回调(参见JavaScript回调)。这种方法将工作在独立的HTML文档或bokeh服务器应用程序。</li>
<li>使用bokeh serve启动一个bokeh服务器，并使用.on_change设置事件处理程序(或者对于某些小部件，使用.on_click)。</li>
</ul>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>下面的小节将收集使用所有内置小部件的简短但完整的示例。通过查看浏览器的Javascript控制台日志，可以观察到许多示例打印的输出。</p>
<h4 id="按钮"><a href="#按钮" class="headerlink" title="按钮"></a>按钮</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> Button, CustomJS</span><br><span class="line"></span><br><span class="line">button = Button(label=<span class="string">"Foo"</span>, button_type=<span class="string">"success"</span>)</span><br><span class="line">button.js_on_click(CustomJS(code=<span class="string">"console.log('button: click!', this.toString())"</span>))</span><br><span class="line"></span><br><span class="line">show(button)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="5abd0f3d-4ee3-4c22-b30c-9d7f5c872caa" data-root-id="65557"></div>





<h4 id="复选框按钮组"><a href="#复选框按钮组" class="headerlink" title="复选框按钮组"></a>复选框按钮组</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CheckboxButtonGroup, CustomJS</span><br><span class="line"></span><br><span class="line">LABELS = [<span class="string">"Option 1"</span>, <span class="string">"Option 2"</span>, <span class="string">"Option 3"</span>]</span><br><span class="line"></span><br><span class="line">checkbox_button_group = CheckboxButtonGroup(labels=LABELS, active=[<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">checkbox_button_group.js_on_click(CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('checkbox_button_group: active=' + this.active, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(checkbox_button_group)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="69f631c4-4676-4434-b329-83eca86d6191" data-root-id="66666"></div>





<h4 id="复选框"><a href="#复选框" class="headerlink" title="复选框"></a>复选框</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CheckboxGroup, CustomJS</span><br><span class="line"></span><br><span class="line">LABELS = [<span class="string">"Option 1"</span>, <span class="string">"Option 2"</span>, <span class="string">"Option 3"</span>]</span><br><span class="line"></span><br><span class="line">checkbox_group = CheckboxGroup(labels=LABELS, active=[<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">checkbox_group.js_on_click(CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('checkbox_group: active=' + this.active, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(checkbox_group)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="888a31c9-918d-43df-9ac0-332bd37c2bef" data-root-id="67775"></div>





<h4 id="颜色选择器"><a href="#颜色选择器" class="headerlink" title="颜色选择器"></a>颜色选择器</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.layouts <span class="keyword">import</span> column</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> ColorPicker</span><br><span class="line"><span class="keyword">from</span> bokeh.plotting <span class="keyword">import</span> Figure</span><br><span class="line"></span><br><span class="line">plot = Figure(x_range=(<span class="number">0</span>, <span class="number">1</span>), y_range=(<span class="number">0</span>, <span class="number">1</span>), plot_width=<span class="number">350</span>, plot_height=<span class="number">350</span>)</span><br><span class="line">line = plot.line(x=(<span class="number">0</span>,<span class="number">1</span>), y=(<span class="number">0</span>,<span class="number">1</span>), color=<span class="string">"black"</span>, line_width=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">picker = ColorPicker(title=<span class="string">"Line Color"</span>)</span><br><span class="line">picker.js_link(<span class="string">'color'</span>, line.glyph, <span class="string">'line_color'</span>)</span><br><span class="line"></span><br><span class="line">show(column(plot, picker))</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="5b276603-de76-46a9-ba78-ba2351350155" data-root-id="68922"></div>





<h4 id="数据表"><a href="#数据表" class="headerlink" title="数据表"></a>数据表</h4><p>Bokeh提供了一个基于SlickGrid的复杂数据表小部件。注意，由于表是用数据源对象配置的，因此共享此数据源的任何绘图都将自动在绘图和表之间链接选择(即使在静态HTML文档中也是如此)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> ColumnDataSource, DataTable, DateFormatter, TableColumn</span><br><span class="line"></span><br><span class="line">data = dict(</span><br><span class="line">        dates=[date(<span class="number">2014</span>, <span class="number">3</span>, i+<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)],</span><br><span class="line">        downloads=[randint(<span class="number">0</span>, <span class="number">100</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)],</span><br><span class="line">    )</span><br><span class="line">source = ColumnDataSource(data)</span><br><span class="line"></span><br><span class="line">columns = [</span><br><span class="line">        TableColumn(field=<span class="string">"dates"</span>, title=<span class="string">"Date"</span>, formatter=DateFormatter()),</span><br><span class="line">        TableColumn(field=<span class="string">"downloads"</span>, title=<span class="string">"Downloads"</span>),</span><br><span class="line">    ]</span><br><span class="line">data_table = DataTable(source=source, columns=columns, width=<span class="number">400</span>, height=<span class="number">280</span>)</span><br><span class="line"></span><br><span class="line">show(data_table)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="3bbf6125-9e6b-4f7d-b522-f3736f879e10" data-root-id="70098"></div>





<h4 id="时间选择器"><a href="#时间选择器" class="headerlink" title="时间选择器"></a>时间选择器</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, DatePicker</span><br><span class="line"></span><br><span class="line">date_picker = DatePicker(title=<span class="string">'Select date'</span>, value=<span class="string">"2019-09-20"</span>, min_date=<span class="string">"2019-08-01"</span>, max_date=<span class="string">"2019-10-30"</span>)</span><br><span class="line">date_picker.js_on_change(<span class="string">"value"</span>, CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('date_picker: value=' + this.value, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(date_picker)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="ebc62c4f-81af-48ff-a4dc-c8de03202176" data-root-id="71246"></div>





<h4 id="日期范围滑块"><a href="#日期范围滑块" class="headerlink" title="日期范围滑块"></a>日期范围滑块</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> bokeh.io <span class="keyword">import</span> show</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, DateRangeSlider</span><br><span class="line"></span><br><span class="line">date_range_slider = DateRangeSlider(value=(date(<span class="number">2016</span>, <span class="number">1</span>, <span class="number">1</span>), date(<span class="number">2016</span>, <span class="number">12</span>, <span class="number">31</span>)),</span><br><span class="line">                                    start=date(<span class="number">2015</span>, <span class="number">1</span>, <span class="number">1</span>), end=date(<span class="number">2017</span>, <span class="number">12</span>, <span class="number">31</span>))</span><br><span class="line">date_range_slider.js_on_change(<span class="string">"value"</span>, CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('date_range_slider: value=' + this.value, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(date_range_slider)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="5fed408c-83e8-4e6b-869a-be4575dc27b4" data-root-id="72369"></div>





<h4 id="div"><a href="#div" class="headerlink" title="div"></a>div</h4><p>用于标签中显示支持HTML的文本的小部件:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> Div</span><br><span class="line"></span><br><span class="line">div = Div(text=<span class="string">"""Your &lt;a href="https://en.wikipedia.org/wiki/HTML"&gt;HTML&lt;/a&gt;-supported text is initialized with the &lt;b&gt;text&lt;/b&gt; argument.  The</span></span><br><span class="line"><span class="string">remaining div arguments are &lt;b&gt;width&lt;/b&gt; and &lt;b&gt;height&lt;/b&gt;. For this example, those values</span></span><br><span class="line"><span class="string">are &lt;i&gt;200&lt;/i&gt; and &lt;i&gt;100&lt;/i&gt;, respectively."""</span>,</span><br><span class="line">width=<span class="number">200</span>, height=<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">show(div)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="17b0fe78-8ea3-4ac5-8912-54c0b65e9d30" data-root-id="73492"></div>





<h4 id="下拉选项"><a href="#下拉选项" class="headerlink" title="下拉选项"></a>下拉选项</h4><p>单击时显示互斥项目的下拉列表的按钮。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, Dropdown</span><br><span class="line"></span><br><span class="line">menu = [(<span class="string">"Item 1"</span>, <span class="string">"item_1"</span>), (<span class="string">"Item 2"</span>, <span class="string">"item_2"</span>), <span class="literal">None</span>, (<span class="string">"Item 3"</span>, <span class="string">"item_3"</span>)]</span><br><span class="line"></span><br><span class="line">dropdown = Dropdown(label=<span class="string">"Dropdown button"</span>, button_type=<span class="string">"warning"</span>, menu=menu)</span><br><span class="line">dropdown.js_on_event(<span class="string">"menu_item_click"</span>, CustomJS(code=<span class="string">"console.log('dropdown: ' + this.item, this.toString())"</span>))</span><br><span class="line"></span><br><span class="line">show(dropdown)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="b31c2d21-ecbb-4df6-907f-d75efe03e088" data-root-id="74614"></div>





<h4 id="选择文件"><a href="#选择文件" class="headerlink" title="选择文件"></a>选择文件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> FileInput</span><br><span class="line"></span><br><span class="line">file_input = FileInput()</span><br><span class="line"></span><br><span class="line">show(file_input)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="d5be2443-0a20-4bb3-a42d-5ea7e1159084" data-root-id="75737"></div>





<h4 id="多项选择"><a href="#多项选择" class="headerlink" title="多项选择"></a>多项选择</h4><p>一个多选择小部件，在一个紧凑的水平布局中显示多个可用选项:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, MultiChoice</span><br><span class="line"></span><br><span class="line">OPTIONS = [<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>, <span class="string">"quux"</span>]</span><br><span class="line"></span><br><span class="line">multi_choice = MultiChoice(value=[<span class="string">"foo"</span>, <span class="string">"baz"</span>], options=OPTIONS)</span><br><span class="line">multi_choice.js_on_change(<span class="string">"value"</span>, CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('multi_choice: value=' + this.value, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(multi_choice)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="a56a19b4-aad9-4076-baa8-b71ccbc8a7b0" data-root-id="76859"></div>





<h4 id="多选一"><a href="#多选一" class="headerlink" title="多选一"></a>多选一</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, MultiSelect</span><br><span class="line"></span><br><span class="line">OPTIONS = [(<span class="string">"1"</span>, <span class="string">"foo"</span>), (<span class="string">"2"</span>, <span class="string">"bar"</span>), (<span class="string">"3"</span>, <span class="string">"baz"</span>), (<span class="string">"4"</span>, <span class="string">"quux"</span>)]</span><br><span class="line"></span><br><span class="line">multi_select = MultiSelect(value=[<span class="string">"1"</span>, <span class="string">"2"</span>], options=OPTIONS)</span><br><span class="line">multi_select.js_on_change(<span class="string">"value"</span>, Custofrom bokeh.models <span class="keyword">import</span> CustomJS, RadioButtonGroup</span><br><span class="line"></span><br><span class="line">LABELS = [<span class="string">"Option 1"</span>, <span class="string">"Option 2"</span>, <span class="string">"Option 3"</span>]</span><br><span class="line"></span><br><span class="line">radio_button_group = RadioButtonGroup(labels=LABELS, active=<span class="number">0</span>)</span><br><span class="line">radio_button_group.js_on_click(CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('radio_button_group: active=' + this.active, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(radio_button_group)mJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('multi_select: value=' + this.value, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(multi_select)</span><br></pre></td></tr></table></figure>
<pre><code>  File &quot;&lt;ipython-input-130-9b7fbcaac8f1&gt;&quot;, line 6
    multi_select.js_on_change(&quot;value&quot;, Custofrom bokeh.models import CustomJS, RadioButtonGroup
                                                 ^
SyntaxError: invalid syntax
</code></pre><h4 id="段落"><a href="#段落" class="headerlink" title="段落"></a>段落</h4><p>用于在HTML标签中显示文本块的小部件:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> Paragraph</span><br><span class="line"></span><br><span class="line">p = Paragraph(text=<span class="string">"""Your text is initialized with the 'text' argument.  The</span></span><br><span class="line"><span class="string">remaining Paragraph arguments are 'width' and 'height'. For this example, those values</span></span><br><span class="line"><span class="string">are 200 and 100, respectively."""</span>,</span><br><span class="line">width=<span class="number">200</span>, height=<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">show(p)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="9cb915bf-5cd5-4ec6-828e-e7ef664a753a" data-root-id="77982"></div>





<h4 id="密码输入框"><a href="#密码输入框" class="headerlink" title="密码输入框"></a>密码输入框</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, PasswordInput</span><br><span class="line"></span><br><span class="line">password_input = PasswordInput(placeholder=<span class="string">"enter password..."</span>)</span><br><span class="line">password_input.js_on_change(<span class="string">"value"</span>, CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('password_input: value=' + this.value, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(password_input)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="c70d7b4e-f65c-429c-b1ad-7d46692455d3" data-root-id="79104"></div>





<h4 id="Pre文本"><a href="#Pre文本" class="headerlink" title="Pre文本"></a>Pre文本</h4><p>用于在HTML 标签中显示一块预格式化文本的小部件:<code>&lt;/pre&gt;</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> PreText</span><br><span class="line"></span><br><span class="line">pre = PreText(text=<span class="string">"""Your text is initialized with the 'text' argument.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The remaining Paragraph arguments are 'width' and 'height'. For this example,</span></span><br><span class="line"><span class="string">those values are 500 and 100, respectively."""</span>,</span><br><span class="line">width=<span class="number">500</span>, height=<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">show(pre)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="7d124902-56e1-4f0d-9c68-2a3415e88003" data-root-id="80227"></div>





<h4 id="单选按钮组"><a href="#单选按钮组" class="headerlink" title="单选按钮组"></a>单选按钮组</h4><p>单选按钮组一次最多可以有一个选择的按钮:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, RadioButtonGroup</span><br><span class="line"></span><br><span class="line">LABELS = [<span class="string">"Option 1"</span>, <span class="string">"Option 2"</span>, <span class="string">"Option 3"</span>]</span><br><span class="line"></span><br><span class="line">radio_button_group = RadioButtonGroup(labels=LABELS, active=<span class="number">0</span>)</span><br><span class="line">radio_button_group.js_on_click(CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('radio_button_group: active=' + this.active, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(radio_button_group)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="41619648-5c0e-4b1c-a111-2af0f790addb" data-root-id="81349"></div>





<h4 id="单选组"><a href="#单选组" class="headerlink" title="单选组"></a>单选组</h4><p>一个单选组使用标准单选按钮外观:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, RadioGroup</span><br><span class="line"></span><br><span class="line">LABELS = [<span class="string">"Option 1"</span>, <span class="string">"Option 2"</span>, <span class="string">"Option 3"</span>]</span><br><span class="line"></span><br><span class="line">radio_group = RadioGroup(labels=LABELS, active=<span class="number">0</span>)</span><br><span class="line">radio_group.js_on_click(CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('radio_group: active=' + this.active, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(radio_group)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="b1d0fe8d-353a-445e-9d23-59cb92eedf2e" data-root-id="82472"></div>





<h4 id="范围滑块"><a href="#范围滑块" class="headerlink" title="范围滑块"></a>范围滑块</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, RangeSlider</span><br><span class="line"></span><br><span class="line">range_slider = RangeSlider(start=<span class="number">0</span>, end=<span class="number">10</span>, value=(<span class="number">1</span>,<span class="number">9</span>), step=<span class="number">.1</span>, title=<span class="string">"Stuff"</span>)</span><br><span class="line">range_slider.js_on_change(<span class="string">"value"</span>, CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('range_slider: value=' + this.value, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(range_slider)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="81ef0632-3308-4590-bff9-8803b72dfc10" data-root-id="83595"></div>





<h4 id="选择"><a href="#选择" class="headerlink" title="选择"></a>选择</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, Select</span><br><span class="line"></span><br><span class="line">select = Select(title=<span class="string">"Option:"</span>, value=<span class="string">"foo"</span>, options=[<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>, <span class="string">"quux"</span>])</span><br><span class="line">select.js_on_change(<span class="string">"value"</span>, CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('select: value=' + this.value, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(select)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="45a48564-f5bf-43d6-bca8-d5429c9fa84e" data-root-id="84718"></div>





<h4 id="滑块"><a href="#滑块" class="headerlink" title="滑块"></a>滑块</h4><p>滑块可以配置“开始”和“结束”值、“步长”、“初始值”和“标题”:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, Slider</span><br><span class="line"></span><br><span class="line">slider = Slider(start=<span class="number">0</span>, end=<span class="number">10</span>, value=<span class="number">1</span>, step=<span class="number">.1</span>, title=<span class="string">"Stuff"</span>)</span><br><span class="line">slider.js_on_change(<span class="string">"value"</span>, CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('slider: value=' + this.value, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(slider)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="b590f535-cff9-4c0a-ac4f-3cedc12ef8a8" data-root-id="85841"></div>





<h4 id="微调控制项"><a href="#微调控制项" class="headerlink" title="微调控制项"></a>微调控制项</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> bokeh.io <span class="keyword">import</span> show</span><br><span class="line"><span class="keyword">from</span> bokeh.layouts <span class="keyword">import</span> column, row</span><br><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> Spinner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x = np.random.rand(<span class="number">10</span>)</span><br><span class="line">y = np.random.rand(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">p = figure(x_range=(<span class="number">0</span>, <span class="number">1</span>), y_range=(<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">points = p.scatter(x=x, y=y, size=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">spinner = Spinner(title=<span class="string">"Glyph size"</span>, low=<span class="number">1</span>, high=<span class="number">40</span>, step=<span class="number">0.5</span>, value=<span class="number">4</span>, width=<span class="number">80</span>)</span><br><span class="line">spinner.js_link(<span class="string">'value'</span>, points.glyph, <span class="string">'size'</span>)</span><br><span class="line"></span><br><span class="line">show(row(column(spinner, width=<span class="number">100</span>), p))</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="e5411f13-255a-47fe-abe1-1e368afd1d53" data-root-id="87003"></div>





<h4 id="选项卡"><a href="#选项卡" class="headerlink" title="选项卡"></a>选项卡</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> Panel, Tabs</span><br><span class="line"><span class="keyword">from</span> bokeh.plotting <span class="keyword">import</span> figure</span><br><span class="line"></span><br><span class="line">p1 = figure(plot_width=<span class="number">300</span>, plot_height=<span class="number">300</span>)</span><br><span class="line">p1.circle([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>], size=<span class="number">20</span>, color=<span class="string">"navy"</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">tab1 = Panel(child=p1, title=<span class="string">"circle"</span>)</span><br><span class="line"></span><br><span class="line">p2 = figure(plot_width=<span class="number">300</span>, plot_height=<span class="number">300</span>)</span><br><span class="line">p2.line([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], [<span class="number">6</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>], line_width=<span class="number">3</span>, color=<span class="string">"navy"</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line">tab2 = Panel(child=p2, title=<span class="string">"line"</span>)</span><br><span class="line"></span><br><span class="line">show(Tabs(tabs=[tab1, tab2]))</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="7bb8f752-e9bf-4a6c-b964-b76bb19c610c" data-root-id="88262"></div>





<h4 id="文本区域输入"><a href="#文本区域输入" class="headerlink" title="文本区域输入"></a>文本区域输入</h4><p>用于从用户那里收集多行文本的小部件:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, TextAreaInput</span><br><span class="line"></span><br><span class="line">text_area_input = TextAreaInput(value=<span class="string">"default"</span>, rows=<span class="number">6</span>, title=<span class="string">"Label:"</span>)</span><br><span class="line">text_area_input.js_on_change(<span class="string">"value"</span>, CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('text_area_input: value=' + this.value, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(text_area_input)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="d18217d6-8e6c-4bd3-aa5e-eea693c27033" data-root-id="89519"></div>






<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, TextInput</span><br><span class="line"></span><br><span class="line">text_input = TextInput(value=<span class="string">"default"</span>, title=<span class="string">"Label:"</span>)</span><br><span class="line">text_input.js_on_change(<span class="string">"value"</span>, CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('text_input: value=' + this.value, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(text_input)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="3de5d16a-a8ad-4b74-939f-7c0937903a10" data-root-id="90669"></div>





<h4 id="开关按钮"><a href="#开关按钮" class="headerlink" title="开关按钮"></a>开关按钮</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bokeh.models <span class="keyword">import</span> CustomJS, Toggle</span><br><span class="line"></span><br><span class="line">toggle = Toggle(label=<span class="string">"Foo"</span>, button_type=<span class="string">"success"</span>)</span><br><span class="line">toggle.js_on_click(CustomJS(code=<span class="string">"""</span></span><br><span class="line"><span class="string">    console.log('toggle: active=' + this.active, this.toString())</span></span><br><span class="line"><span class="string">"""</span>))</span><br><span class="line"></span><br><span class="line">show(toggle)</span><br></pre></td></tr></table></figure>
<div class="bk-root" id="fdd5b0bc-87b7-481c-8161-64f0dc4141ce" data-root-id="91819"></div>




</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Guanghao</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://lguanghao.com/2020/10/31/Bokeh/">http://lguanghao.com/2020/10/31/Bokeh/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://lguanghao.com" target="_blank">Liu's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BB%98%E5%9B%BE/">绘图</a><a class="post-meta__tags" href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/">可视化</a></div><div class="post_share"><div class="social-share" data-image="/img/bokeh.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2020/09/25/%E8%87%AA%E7%BB%84%E7%BB%87%E6%98%A0%E5%B0%84%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/"><img class="next-cover" data-src="/img/som.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">自组织映射神经网络</div></div></a></div></nav></article></main><footer id="footer" style="background-image: url(/img/mountains.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By Guanghao</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script defer id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false});</script></body></html>